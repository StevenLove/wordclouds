{"version":3,"sources":["js/fabric.js","js/board.js","js/Text.js","js/Sprite.js","js/canvasutils.js","js/fabricutils.js","js/compressedoperations.js","js/artist.js","logo.svg","js/spiral.js","js/utils.js","js/constants.js","js/settings.js","components/TextInput.jsx","components/TextSeparation.jsx","components/TextRotation.jsx","components/ColorBox.jsx","components/FontBox.jsx","components/ImageUpload.jsx","components/BoardPreview.jsx","components/DrawControls.jsx","components/index.jsx","App.js","serviceWorker.js","index.js"],"names":["scratchCanvas","fabric","require","$","console","log","named","getCanvas","width","height","$canvasElement","css","append","staticCanvas","StaticCanvas","enableRetinaScaling","lowerCanvasEl","attr","module","exports","display","fab","$el","getScratchCanvas","clear","fromID","id","Image","Text","Rect","Color","Spiral","Sprite","constants","fabricutils","utils","seedrandom","AttributeManager","seed","this","_options","_seed","reset","Board","Math","random","resetAttributeManagers","_palette","_angles","_fonts","texts","_width","BLANKET_WIDTH_PIXELS","_height","BLANKET_HEIGHT_PIXELS","_bg","mode","color","_sprite","fromDimensions","prototype","_rand","getRandom","length","GetRandomElement","options","arguments","fontAttributeManager","fonts","colorAttributeManager","palette","rotationAttributeManager","angles","setExistingColors","_this","fabcan","forEachObject","obj","c","set","renderAll","newvalue","_fabcan","setDimensions","backstoreOnly","forEach","prop","newValue","undefined","updateBG","updateShape","sprite","fromBackgroundImage","shape","filename","inverted","invert","addSprite","toSprite","_this2","bg","getBGColor","showSpiral","spiral","hasNext","loc","next","drawDot","_this$fabcan","remove","apply","Object","C_Users_Steven_Desktop_Programming_wordclouds_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","getObjects","clearColor","tryToPlace","text","_this3","fontFamily","angle","Promise","res","rej","setTimeout","rectangular","x","y","canPlace","place","toFabric","_leftOffsetToCenter","_topOffsetToCenter","add","collidesWithOffsetSprite","draw","matchSpriteToCanvas","s","fromFabric","showSpriteOnCanvas","canvasID","spriteFabcan","Utils","_text","_color","_fontFamily","_fontSize","_angle","_strokeWidth","e","_fab","includes","left","top","fill","hex","stroke","fontSize","strokeWidth","getBounds","scratch","fab_text","bounds","getBoundingRect","floor","ceil","fixOffset","fabObj","b","w","h","boundingRect","toImageData","contextContainer","getImageData","fromImageData","data","putImageData","image_data","compressedOps","isClear","r","g","a","isWhite","isTransparent","habitableFunction","xoff","yoff","inhabitedColor","uninhabitedColor","compressedBuffer","len","Array","fullyUninhabited","fullyInhabited","v","map","int","imageData","single_integer","buffer","bufferLength","result","outerIndex","PIXEL_LENGTH_BLURRED","innerIndex","PIXEL_LENGTH","index","push","image","src","$imgElement","fabImage","toFabricAsync","dataURL","toCanvas","toDataURL","fromURL","img","then","newfab","canvas","$newCanvas","pixelIndex","stripIndex","strip","baseDestPixelIndex","ctx","_canvas","getContext","imgData","createImageData","rA","red","gA","green","bA","blue","aA","alpha","rB","gB","bB","aB","numStrips","strips","i","other","collide","or","callback","dataurl","fabric_canvas","load","fabric_image","compressedConstants","save","canv","url","sameDimensions","canvasA","canvasB","getWidth","getHeight","colorIsVisible","getSource","opaque","low_red","low_green","low_blue","availableColor","unavailableColor","phraseToFabric","phrase","placed_x","placed_y","font","size","adjustedBoundingBox","bound","loaded_img","setStrokeWidth","clearWhite","equalCanvases","imageDataA","imageDataB","dataA","dataB","objToCanvas","colorsEqual","colorA","colorB","srcA","srcB","colorToAvailability","zoomCanvas","factor","setHeight","setWidth","backgroundImage","bi","objects","tempScaleX","scaleX","tempScaleY","scaleY","tempLeft","tempTop","setCoords","calcOffset","intersectionTest","topWidth","topHeight","botWidth","botHeight","max","right","min","bottom","JSON","stringify","operateOnCompressedRows","topArray","botArray","operation","intersect","stop","value","testCompressedBitsForCollision","topOffset","botOffset","totalBits","operateOnCompressedBits","topChunk","topChunkIndex","botChunk","collision","orOp","destArray","destIndex","srcChunk","orNotOp","opOnRows","opOnRow","srcArray","destOffset","srcOffset","numBits","destChunkIndex","destChunkOffset","srcChunkIndex","srcChunkOffset","destChunk","results","chunkMask","numBitsProcessed","bot","topChunkOffset","botChunkOffset","numBitsFromBot","bidirectionalRightShift","bitsFrom","orCompressedBits","botChunkIndex","unboundedUnsignedRightShift","shamt","integer","start","num","fromRight","multiplier","rightshamt","PIXELS_PER_STRIP","PIXEL_STRIP_LENGTH","orBottomOntoTop","orNot","outerWidth","outerHeight","innerWidth","innerHeight","withinTest","random32Bit","__test__","MIN_WORD_SIZE","curWordSize","Artist","_id","_separator","_words","_wordIndex","_autoRedraw","_board","_serializer","Serializer","calculateWords","sep","trim","split","t","separator","board","words","placeEachWord","bind","word","promise","catch","reject","on","__webpack_require__","p","LoadedSpiral","generatorFn","maxT","maxMaxT","xs","ys","maxX","maxY","generateFrom","genFn","generator","tempTime","archimedean","nextVal","xOrigin","yOrigin","at","cos","sin","time","dx","limit","sqrt","count","RandomInRange","rand","GetRandomIndex","array","error","ArrayToFrequencyObject","arr","reduce","item","current_count","Shuffle","temporaryValue","randomIndex","currentIndex","WholeNumbers","Observer","handlers","Timer","delayTime","repeats","obs","handle","_inProgress","off","filter","notify","_arguments","clearTimeout","repeat","bool","delay","ms","repeatEvery","destroyWith","scope","$on","f","queue","busy","call","finally","callFinished","stopping","resolve","shift","firstFunction","callerID","_this$obs","toExport","getPropertySafe","args","from","acc","curr","setPropertySafe","propertyName","propertyValue","setSafe","concat","slice","asyncSequentially","fn","element","CloneObject","hasOwnProperty","CloneArray","GetModuloElement","RandomIntInRange","RandomSubset","subset_len","all_indices","Update","updater","FindClosestItemInList","list","diff","abs","prev","IsString","variable","LogBaseBofX","base","RemoveDuplicates","keys","Clamp","val","assign","target","TypeError","output","source","nextKey","isInteger","SetGlobalSeed","global","assertHasProperties","assertHasProperty","defaultTexts","timer","mostUpToDateText","defaultProtoPhrases","makePalette","name","colors","defaultPalette","palettes","sizes","xl","l","m","makeSizer","makePlateauSizer","makeStaticSizer","randomSizer","getRandomElement","settings","defaultSizer","sizers","defaultShape","type","file","textBankStrings","safeColors","namedShapeSizes","blanket","TextInput","handleTextChangeEvent","props","handleUpdate","react_default","createElement","rows","onChange","React","Component","label","TextSeparation","state","handleChange","setState","className","dropdown","nameToDegreeArrays","flat","cross","first","fourth","ltr","any","TextRotation","handleSetRotationName","rotationName","degreeArray","valueArray","handleSelectEvent","ColorLibrary","BackgroundColorPicker","handleColorClick","styleString","style","backgroundColor","onSetBG","preview","ColorBox_Color","paletteColors","checked","ColorBox_ColorStrip","onClick","handleClick","ColorStrip","key","Palette","_this4","onSetPalette","selected","TextColorPicker","_this5","paletteObjs","ColorBox_Palette","DEFAULT_FONTS","FontDropdown","all","self","multiselect","event","itemTemplate","option","selectedItemTemplate","fontName","FontBox","values","FontBox_FontDropdown","ImageUpload","classCallCheck","possibleConstructorReturn","getPrototypeOf","onDrop","files","newShape","handleSetShape","handleSetType","handleSetSize","handleSetPresetName","presetName","logoPath","alt","margin","float","verticalAlign","marginRight","extraOptions","togglebutton","onLabel","offLabel","onChangeInverted","onChangeFilename","carTemplate","placeholder","BoardPreview","PureComponent","DrawControls","autoRedraw","primereact_button","App","handleUpdateSeed","handleUpdateText","artist","handleUpdateSeparation","handleUpdateRotation","handleUpdateFont","handleSetPalette","newPalette","handleSetBG","accordion","header","components_TextInput","components_TextSeparation","components_FontBox","components_TextRotation","ColorBox_TextColorPicker","ColorBox_BackgroundColorPicker","components_ImageUpload","components_BoardPreview","components_DrawControls","showSprite","components","Boolean","window","location","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.ba7fd58d.chunk.js","sourcesContent":["var fabric = require('fabric').fabric;\r\nlet $ = require(\"jquery\");\r\n\r\nconsole.log(\"my fabric js\",fabric);\r\n\r\n// let proxy = new Proxy({\r\n//     StaticCanvas:fabric.StaticCanvas,\r\n//     Color:fabric.Color,\r\n//     // initialize:fabric.initialize\r\n// },{\r\n//     get: function(obj, prop) {\r\n//         if(prop in obj){\r\n//             return obj[prop];\r\n//         }\r\n//         console.warn(\"Looking for property fabric.\"+prop+\" not found in our custom fabric proxy\");\r\n//         return undefined;\r\n//     }\r\n    \r\n// })\r\n\r\nlet scratchCanvas;\r\nfunction getScratchCanvas(){\r\n    if(!scratchCanvas){\r\n        scratchCanvas = getCanvas(768,1025);\r\n    }\r\n    scratchCanvas.clear();\r\n    // var rect = new fabric.Rect({\r\n    //     width:1000,height:1000,fill: 'black', left: 0, top: 0});\r\n    // scratchCanvas.add(rect);\r\n    return scratchCanvas;\r\n    // let options = {};\r\n    // scratchCanvas = new fabric.StaticCanvas(document.querySelector(\"#scratch\"),options);\r\n    // return scratchCanvas;\r\n    // return getCanvas(100,100);\r\n}\r\nlet named = {}\r\nfunction fromID(id){\r\n    if(named[id])return named[id];\r\n    named[id] = new fabric.StaticCanvas(id,{width:300,height:400,enableRetinaScaling:false});\r\n    return named[id];\r\n}\r\nfunction getCanvas(width,height){\r\n    console.log(\"getting canvas with wh\",width,height);\r\n    let $canvasElement = $(\"<canvas>\").css(\"display\",\"none\");\r\n    $(\"body\").append($canvasElement);\r\n    let staticCanvas = new fabric.StaticCanvas($canvasElement[0],{width:width,height:height,enableRetinaScaling:false});\r\n    let $el = $(staticCanvas.lowerCanvasEl);\r\n    $el.attr(\"width\",width).attr(\"height\",height); // if we don't do this, then the canvas is set to be bigger, but then css styled down to be smaller...\r\n    // display(staticCanvas);\r\n    return staticCanvas;\r\n}\r\n\r\n/* Will mess up if the fab already exists! */\r\nfunction display(fab){\r\n    console.log(\"display\",fab);\r\n    let $el = $(fab.lowerCanvasEl);\r\n    $el.attr(\"width\",fab.width).attr(\"height\",fab.height);\r\n    $(\"body\").append($el);\r\n}\r\nmodule.exports = {\r\n    display,\r\n    getScratchCanvas,\r\n    getCanvas,\r\n    fromID,\r\n    Image:fabric.Image,\r\n    Text:fabric.Text,\r\n    Rect:fabric.Rect,\r\n    StaticCanvas:fabric.StaticCanvas,\r\n    Color:fabric.Color,\r\n}\r\n// module.exports = proxy;","// var spriter = require(\"./spriter.js\");\nvar Spiral = require(\"./spiral.js\");\nlet Sprite = require(\"./Sprite.js\");\n// let Text = require(\"./Text.js\");\nlet Color = require(\"color\");\nlet constants = require(\"./constants.js\");\nvar fabric = require(\"./fabric.js\");\nvar fabricutils = require(\"./fabricutils.js\");\nlet utils = require(\"./utils.js\");\nlet seedrandom = require(\"seedrandom\");\n\nfunction AttributeManager(seed){\n  this._options = [];\n  this._seed = seed;\n  this.reset();\n}\nAttributeManager.prototype.reset = function(){this._rand = seedrandom(this._seed);return this;}\nAttributeManager.prototype.getRandom = function(){\n  if(this._options && this._options.length > 0){\n    return utils.GetRandomElement(this._options,this._rand);\n  }\n}\nAttributeManager.prototype.options = function(){\n  if(arguments.length > 0){\n    this._options = arguments[0];\n    return this;\n  }\n  else{\n    return this._options;\n  }\n}\n\nfunction Board(){\n  this._seed = Math.random();\n  this.resetAttributeManagers();\n  this._palette=[\"#000000\"];\n  this._angles=[0];\n  this._fonts=[\"courier\"];\n  this.texts = [];\n  this._width = constants.BLANKET_WIDTH_PIXELS;\n  this._height = constants.BLANKET_HEIGHT_PIXELS;\n  this._bg = {mode:\"transparent\",color:\"rgb(255,255,255)\"}\n  this._sprite = new Sprite().fromDimensions(this._width,this._height);\n  // this._fabcan;\n  // this.worker = new Worker(\"./worker.js\");\n  return this;\n}\nBoard.prototype.resetAttributeManagers = function(){\n  this.fontAttributeManager = new AttributeManager(this.seed()).options(this.fonts());\n  this.colorAttributeManager = new AttributeManager(this.seed()).options(this.palette());\n  this.rotationAttributeManager = new AttributeManager(this.seed()).options(this.angles());\n}\n/* Reapply current color rules to all existing fabric text elements on the page */\nBoard.prototype.setExistingColors = function(){\n  console.log(\"set existing colors\",this);\n  this.fabcan().forEachObject(obj=>{\n    if(obj instanceof fabric.Text){\n      let c = this.colorAttributeManager.getRandom();\n      console.log(\"color set to \",c);\n      obj.set(\"stroke\",c);\n      obj.set(\"fill\",c);\n    }\n  })\n  this.fabcan().renderAll();\n}\nBoard.prototype.fabcan = function(newvalue){\n  if(newvalue){\n    this._fabcan = newvalue;\n    console.log(\"setting dimensions\",this.width(),this.height());\n    this._fabcan.setDimensions({width:this.width(),height:this.height()},{backstoreOnly:true})\n    // this._fabcan.setWidth(this.width());\n    // this._fabcan.setHeight(this.height());\n    return this;\n  }\n  else{\n    if(!this._fabcan){\n      this._fabcan = fabric.getCanvas(this.width(),this.height());\n    }\n    return this._fabcan;\n  }\n};\n\n[\"bg\",\"width\",\"height\",\"sprite\",\"seed\",\"palette\",\"angles\",\"fonts\",\"shape\"].forEach(prop=>{\n  Board.prototype[prop] = function(newValue){\n      if(newValue===undefined){return this[\"_\"+prop]} // get the property\n      this[\"_\"+prop] = newValue; // set the property\n      if(prop==\"angles\" || prop==\"fonts\" || prop == \"palette\" || prop == \"seed\"){this.resetAttributeManagers();}\n      // if(prop==\"seed\"){this.resetAttributeManagers();} // automatically update the random number generator if we change the seed\n      if(prop==\"palette\"){this.setExistingColors();}\n      if(prop==\"bg\"){this.updateBG();}\n      if(prop==\"shape\"){this.updateShape();}\n      return this;\n   }\n})\nBoard.prototype.updateShape = function(){\n  let sprite = new Sprite().fromBackgroundImage(this.shape().filename);\n  if(this.shape().inverted){\n    sprite.invert();\n  }\n  this.sprite().clear().addSprite(sprite,0,0);\n}\nBoard.prototype.toSprite = function(){\n  return this.sprite();\n};\nBoard.prototype.updateBG = function(){\n  this.fabcan().forEachObject(obj=>{\n    if(obj.id==\"bg\"){\n      console.log(\"board applying bg\",this.bg(),\"to el\",obj);\n      obj.set(\"fill\",this.getBGColor());\n      this.fabcan().renderAll();\n    }\n  })\n}\nBoard.prototype.getBGColor = function(){\n  if(this.bg().mode==\"transparent\"){\n   return \"rgba(0,0,0,0)\"\n  }\n  else{\n    return this.bg().color;\n  }\n}\nBoard.prototype.showSpiral = function(spiral){\n    spiral.reset();\n    while(spiral.hasNext()){\n      let loc = spiral.next();\n      fabricutils.drawDot(this.fabcan(),loc[0],loc[1]);\n    }\n}\nBoard.prototype.clear = function(){\n  this.resetAttributeManagers();\n  this.fabcan().remove(...this.fabcan().getObjects());\n  fabricutils.clearColor(this.fabcan(),this.getBGColor());\n  // this.showSpiral(Spiral.random);\n  if(this.shape()){\n    this.updateShape();\n  }\n  else{\n    this.sprite(new Sprite().fromDimensions(this.width(),this.height()));\n  }\n  return this;\n};\nBoard.prototype.tryToPlace = function(text){\n  // console.log(\"trying to place\",text.text());\n\n  text.fontFamily(this.fontAttributeManager.getRandom());\n  text.angle(this.rotationAttributeManager.getRandom());\n  \n\n  return new Promise((res,rej)=>{\n    setTimeout(()=>{\n      let spiral = Spiral.rectangular;// Spiral.random(this.width()-1,this.height()-1);\n      spiral.reset();\n      // var spiral = Spiral.archimedean(this.width()-1,this.height()-1);\n      while(spiral.hasNext()){\n        var loc = spiral.next();\n        // console.log(JSON.stringify(loc));\n        var x = loc[0] | 0;\n        var y = loc[1] | 0;\n        if(this.canPlace(text,x,y)){\n          text.color(Color(this.colorAttributeManager.getRandom())); // only get a random color for words we can actually place. This way we get the same randomness as when we iterate over existing words\n          this.place(text,x,y);\n          res();\n          // console.log(\"after place\");\n          return;\n        }\n      }\n      rej();\n      console.log(\"failed to place\");\n    })\n  })\n  \n  // this.worker.postMessage(text);\n  \n}\nBoard.prototype.place = function(text, x,y){\n    this.sprite().addSprite(text.toSprite(),x,y);\n    // console.log(\"after placement sprite\",this.sprite());\n    // this.sprite(text.toSprite());\n    var fab = text.toFabric();\n    fab.set(\"left\",x+text._leftOffsetToCenter);\n    fab.set(\"top\",y+text._topOffsetToCenter);\n    this.fabcan().add(fab);\n}\nBoard.prototype.canPlace = function(text,x,y){\n  return !this.sprite().collidesWithOffsetSprite(text.toSprite(),x,y);\n}\nBoard.prototype.draw = function(){\n  // if(this._fabcan){\n  //   // this.fabcan().renderAll();\n  //   return this;\n  // }\n  // fabric.display(this.fabcan());\n  // return this;\n\n  if(!this._fabcan){\n    this._fabcan = fabric.getCanvas(this.width(),this.height());\n    // fabric.display(this._fabcan);\n  }\n  else{\n    let f = this._fabcan;\n      // f.clear();\n      // f.add(new fabric.Rect({width:10,height:20,fill:\"red\"}));\n  }\n}\nBoard.prototype.matchSpriteToCanvas = function(){\n  let s = new Sprite().fromFabric(this.fabcan());\n  this.sprite(s);\n  return this;\n}\nBoard.prototype.showSpriteOnCanvas = function(canvasID){\n  let spriteFabcan = fabric.fromID(canvasID);\n  this.toSprite().draw(spriteFabcan);\n}\n\n\nmodule.exports = Board;\n\n","let fabric = require(\"./fabric.js\");\r\nlet Color = require(\"color\");\r\nlet Utils = require('./utils.js');\r\nlet Sprite = require(\"./Sprite.js\");\r\n\r\nfunction Text(){\r\n    this._text = \"hello world\"; \r\n    this._color = Color(\"#000000\");\r\n    this._fontFamily = \"Courier\";\r\n    this._fontSize = 12;\r\n    this._angle = 0;\r\n    this._strokeWidth = 1\r\n    // this._leftOffsetToCenter;\r\n    // this._topOffsetToCenter;\r\n    return this;\r\n};\r\n\r\n\r\n[\"text\",\"color\",\"fontFamily\",\"fontSize\",\"angle\",\"strokeWidth\",\"sprite\"].forEach(prop=>{\r\n    Text.prototype[prop] = function(newValue){\r\n        if(newValue===undefined){return this[\"_\"+prop]}\r\n        if(prop==\"color\"){\r\n            try{\r\n                newValue = Color(newValue);\r\n            }\r\n            catch(e){newValue = Color(\"black\")}\r\n        }\r\n        if(prop==\"fontSize\"){\r\n            if(newValue < 6) newValue = 6;\r\n        }\r\n        if(prop==\"angle\"){\r\n            console.log(\"text new angle\",newValue);\r\n        }\r\n        this[\"_\"+prop] = newValue;\r\n        this._fab = undefined; // if we changed a property, invalidate the old fab\r\n        if([\"text\",\"fontFamily\",\"fontSize\",\"angle\",\"strokeWidth\"].includes(prop)){\r\n            this._sprite = undefined; // if we changed a property, invalidate the old sprite\r\n        }\r\n        return this;\r\n     }\r\n})\r\n\r\nText.prototype.toFabric = function(){\r\n    if(this._fab)return this._fab;\r\n    this._fab = new fabric.Text(\r\n        this.text(),\r\n        {\r\n          left: 0,\r\n          top: 0,\r\n          fill: this.color().hex(),\r\n          stroke: this.color().hex(),\r\n          fontFamily: this.fontFamily(),\r\n          fontSize: this.fontSize(),\r\n          angle: this.angle(),\r\n          // stroke: \"#000000\",\r\n          strokeWidth: this.strokeWidth(),\r\n  \r\n        }\r\n      );\r\n    return this._fab;\r\n}\r\n\r\nText.prototype.getBounds = function(){\r\n    let scratch = fabric.getScratchCanvas();\r\n    let fab_text = this.toFabric();\r\n    // get the dimensions of this bad boy\r\n    scratch.add(fab_text);\r\n    var bounds = fab_text.getBoundingRect();\r\n    bounds.left = Utils.floor(bounds.left);\r\n    bounds.top = Utils.floor(bounds.top);\r\n    bounds.width = Utils.ceil(bounds.width);\r\n    bounds.height = Utils.ceil(bounds.height);\r\n    return bounds;\r\n}\r\n\r\nText.prototype.fixOffset = function(){\r\n    /* automatically adjust the top/left to be at (1,1) */\r\n    let fabObj = this.toFabric();\r\n    // if we didn't move this to (0,0) first then we could get the wrong impression of where it needs to be offset\r\n    fabObj.set(\"left\",0);\r\n    fabObj.set(\"top\",0);\r\n    let bounds = this.getBounds();\r\n    fabObj.set(\"left\",-bounds.left);\r\n    fabObj.set(\"top\",-bounds.top);\r\n    this._leftOffsetToCenter = -bounds.left;\r\n    this._topOffsetToCenter = -bounds.top;\r\n}\r\n\r\n/* Draw a text\r\noptionally input a fabric canvas and we'll draw the text on that canvas */\r\nText.prototype.draw = function(fab){\r\n    let b = this.getBounds();\r\n    let w = b.width;\r\n    let h = b.height;\r\n\r\n    /* bounds to be drawn */\r\n    let boundingRect = new fabric.Rect({\r\n        left: 0,\r\n        top: 0,\r\n        width: w,\r\n        height: h,\r\n        fill: 'rgba(0,0,0,0)', // no fill\r\n        stroke: 'red',\r\n        strokeWidth: 1\r\n     });\r\n\r\n    let fab_text = this.toFabric();\r\n    this.fixOffset();\r\n\r\n    if(!fab){\r\n        let newfab = fabric.getCanvas(w,h);\r\n        newfab.add(fab_text,boundingRect);\r\n        // fabric.display(newfab);\r\n    }\r\n    else{\r\n        fab.add(fab_text,boundingRect);\r\n        // fab.renderAll();\r\n    }\r\n    return this;\r\n}\r\nText.prototype.toImageData = function(){\r\n    let scratch = fabric.getScratchCanvas(); // clears the scratch canvas\r\n    let b = this.getBounds(); // draws the text on it\r\n    \r\n    // let fab = this.toFabric();\r\n    // scratch.add(fab); // we don't need to add because getting the bounds did so\r\n    scratch.renderAll(); // otherwise the canvas will still be blank when we try to get the image data\r\n    // fabric.display(scratch);\r\n    var image_data = scratch.contextContainer.getImageData(0,0,b.width,b.height);\r\n    return image_data;\r\n}\r\nText.prototype.fromImageData = function(data){\r\n    let c = fabric.getCanvas(200,200);\r\n    c.contextContainer.putImageData(data,0,0);\r\n}\r\n\r\nText.prototype.toSprite = function(){\r\n    if(this._sprite)return this._sprite;\r\n    // this.angle(0);\r\n    console.log(\"to sprite of text\",this._text,this);\r\n    let scratch = fabric.getScratchCanvas(); // automatically clears the scratch canvas\r\n    let b = this.getBounds(); // gets the bounds but it also draws the text on the canvas so we don't need to redo that step\r\n    this.fixOffset();\r\n    \r\n    scratch.renderAll(); // otherwise the canvas may still be blank when we try to get the image data\r\n    var image_data = scratch.contextContainer.getImageData(0,0,b.width,b.height);\r\n    this.sprite(new Sprite().fromImageData(image_data));\r\n    return this._sprite\r\n}\r\n\r\nmodule.exports = Text;","\r\n\r\nlet $ = require(\"jquery\");\r\nlet fabric = require(\"./fabric.js\");\r\nlet Color = require(\"color\");\r\nlet Utils = require('./utils.js');\r\n// let Canvas = require(\"Canvas-browserify\"); \r\nlet canvasutils = require(\"./canvasutils.js\");\r\nlet compressedOps = require('./compressedoperations.js');\r\n\r\n\r\nconst PIXEL_BLUR = 1; // change to 3 and we will check a pixel and then assume the next 2 are the same and just store the 1 value to cut total size down by 2/3\r\nconst PIXEL_LENGTH = 4;\r\nconst PIXEL_LENGTH_BLURRED = PIXEL_LENGTH*PIXEL_BLUR;\r\nconst PIXELS_PER_STRIP = 32; // actually stored in a strip\r\nconst PIXEL_STRIP_LENGTH = (PIXEL_LENGTH_BLURRED)* PIXELS_PER_STRIP ;\r\n// const DIST_BETWEEN_PIXELS = 8;\r\n\r\nconst UNINHABITED = 0;\r\nconst INHABITED = 1;\r\n\r\nfunction isTransparent(r,g,b,a){return a == 0;}\r\nfunction isClear(r,g,b,a){return isWhite(r,g,b,a) || isTransparent(r,g,b,a)};\r\nfunction isVisible(r,g,b,a){return !isClear(r,g,b,a)}\r\nfunction isBlack(r,g,b,a){return (r==0 && g==0 && b==0 && a==255);};\r\nfunction isWhite(r,g,b,a){return (r == 255 && g == 255 && b == 255 && a == 255);};\r\n\r\n\r\nfunction Sprite(){\r\n    this.habitableFunction = isClear;\r\n    // this._canvas;\r\n    // this._fab;\r\n    // this.width;\r\n    // this.height;\r\n    this.xoff=0;\r\n    this.yoff=0;\r\n    this.inhabitedColor = Color(\"red\");\r\n    this.uninhabitedColor = Color(\"white\");\r\n    this.compressedBuffer = [];\r\n    return this;\r\n};\r\nSprite.prototype.fabcan = function(newValue){\r\n    if(newValue===undefined){return this._fabcan};\r\n    this._fabcan = newValue;\r\n    this._fabcan.setDimensions({width:this.width,height:this.height},{backstoreOnly:true});\r\n    return this;\r\n};\r\n\r\n[\"canvas\",\"xoff\",\"yoff\"].forEach(prop=>{\r\n    Sprite.prototype[prop] = function(newValue){\r\n        if(newValue===undefined){return this[\"_\"+prop]}\r\n        this[\"_\"+prop] = newValue;\r\n        return this;\r\n     }\r\n})\r\n\r\nSprite.prototype.fromDimensions = function(w,h){\r\n    this.width = w;\r\n    this.height = h;\r\n    let len = Utils.ceil(w*h/PIXELS_PER_STRIP);\r\n    this.compressedBuffer = new Array(len);\r\n    this.fullyUninhabited();\r\n    return this;\r\n}\r\n\r\nSprite.prototype.fullyInhabited = function(){\r\n    return this.fill(-1);\r\n}\r\nSprite.prototype.fullyUninhabited = function(){\r\n    return this.fill(0);\r\n}\r\nSprite.prototype.clear = function(){\r\n    return this.fullyUninhabited();\r\n}\r\nSprite.prototype.fill = function(v){\r\n    this.compressedBuffer.fill(v);\r\n    return this;\r\n}\r\nSprite.prototype.invert = function(){\r\n    console.log(\"inverting sprite\",this,this.compressedBuffer);\r\n    this.compressedBuffer = this.compressedBuffer.map(int=>~int); // bitwise invert each int in the compressed buffer\r\n}\r\n\r\n\r\n\r\n// Principle functions:\r\n// compressImageData: compresses a canvas imageData object to an array of ints\r\n// toCanvas: decompresses a sprite back into a canvas\r\n\r\n// image_data: imageData object from a call to Context.getImageData\r\n//   which has width, height, and data\r\n//   data is a typed array of 8bit unsigned ints laid out like the following:\r\n//   [R0,G0,B0,A0,R1,G1,B1,A1,R2,G2,B2,A2,...]\r\n// output an array of 32 bit integers, where one integer represents \r\n//   32 colors from the input imageData.  Each color (RGBA) is turned into\r\n//   a 1 or 0 based on whether it fits my arbitrary cutoff for being dark\r\n//   so the length of the output array is 1/128 the length of image_data.data\r\n\r\nSprite.prototype.fromImageData = function(imageData){\r\n    let w = imageData.width;\r\n    let h = imageData.height;\r\n    this.width = w;\r\n    this.height = h;\r\n    let buffer = imageData.data;\r\n    let numPixels = w*h;\r\n    let bufferLength = numPixels * PIXEL_LENGTH;\r\n  \r\n    let result = [];\r\n    let single_integer;\r\n  \r\n    let r,g,b,a;\r\n    for (let outerIndex = 0;\r\n      outerIndex < bufferLength;\r\n      outerIndex += PIXEL_STRIP_LENGTH){\r\n      single_integer = 0;\r\n      for(let innerIndex = 0;\r\n        innerIndex < PIXEL_STRIP_LENGTH;\r\n        innerIndex += PIXEL_LENGTH_BLURRED){\r\n  \r\n        // calculate the index of a color in the image_data.data array\r\n        let index = outerIndex + innerIndex;\r\n        // extract that individual color\r\n        r = buffer[index];\r\n        g = buffer[index+1];\r\n        b = buffer[index+2];\r\n        a = buffer[index+3];\r\n        // determine if the pixel counts as a 0 or a 1\r\n        let inhabited_bit = !this.habitableFunction(r,g,b,a);\r\n        // add that bit to the end of the integer we are building\r\n        single_integer = (single_integer << 1) + inhabited_bit;\r\n  \r\n      }\r\n      result.push(single_integer);\r\n    }\r\n\r\n    this.compressedBuffer = result;\r\n    return this;\r\n}\r\nSprite.prototype.fromBackgroundImage = function(image){\r\n    console.log(\"sprite from background image\",image);\r\n    let src = \"./images/\"+image;\r\n    let fab = fabric.getCanvas(768,1025);\r\n    let $imgElement = $(\"<img>\").attr(\"src\",src).css(\"display\",\"none\");\r\n    $(\"body\").append($imgElement);\r\n    let fabImage = new fabric.Image($imgElement[0],{\r\n        width:fab.width,\r\n        height:fab.height,\r\n        left:0,\r\n        top:0\r\n    })\r\n    fab.add(fabImage);\r\n    fab.renderAll();\r\n    return new Sprite().fromFabric(fab);\r\n    \r\n}\r\nSprite.prototype.fromFabric = function(fab){\r\n    if(!fab.contextContainer){\r\n        let scratch = fabric.getScratchCanvas(); // automatically clears the scratch canvas\r\n        scratch.add(fab);\r\n        scratch.renderAll(); // otherwise the canvas may still be blank when we try to get the image data\r\n        var image_data = scratch.contextContainer.getImageData(0,0,fab.width,fab.height);\r\n        return this.fromImageData(image_data);\r\n    }\r\n    return this.fromImageData(fab.contextContainer.getImageData(0,0,fab.width,fab.height));\r\n}\r\nSprite.prototype.toFabricAsync = function(){\r\n    return new Promise((res,rej)=>{\r\n        let canvas = this.toCanvas();\r\n        let dataURL = canvas.toDataURL();\r\n        fabric.Image.fromURL(dataURL, function(img) {\r\n            res(img);\r\n        });\r\n    })\r\n}\r\nSprite.prototype.draw = function(fab){\r\n    if(fab){\r\n        this.fabcan(fab);\r\n    }\r\n    if(!this.fabcan()){\r\n        let newfab = fabric.getCanvas(this.width,this.height);\r\n        this.toFabricAsync().then(fabObj=>{\r\n            newfab.add(fabObj);\r\n            // fabric.display(newfab);\r\n            this.fabcan(newfab);\r\n        })\r\n    }\r\n    else{\r\n        this.toFabricAsync().then(fabObj=>{\r\n            this.fabcan().clear();\r\n            this.fabcan().add(fabObj);\r\n            this.fabcan().renderAll();\r\n        })\r\n    }\r\n    return this;\r\n};\r\n\r\nSprite.prototype.toCanvas = function(){\r\n    if(!this.canvas()){\r\n        let $newCanvas = $(\"<canvas>\").attr(\"width\",this.width).attr(\"height\",this.height).css(\"display\",\"none\");\r\n        $(\"body\").append($newCanvas);\r\n        this.canvas($newCanvas[0]);\r\n    }\r\n    var ctx = this._canvas.getContext('2d');\r\n    var imgData = ctx.createImageData(this.width,this.height);\r\n    \r\n\r\n    var rA = this.inhabitedColor.red();\r\n    var gA = this.inhabitedColor.green();\r\n    var bA = this.inhabitedColor.blue();\r\n    var aA = this.inhabitedColor.alpha()*255 | 0; // floor\r\n\r\n    var rB = this.uninhabitedColor.red();\r\n    var gB = this.uninhabitedColor.green();\r\n    var bB = this.uninhabitedColor.blue();\r\n    var aB = this.uninhabitedColor.alpha()*255 | 0; // floor\r\n\r\n    let numPixels = this.width*this.height;\r\n    let numStrips = numPixels / (PIXELS_PER_STRIP);\r\n    \r\n    var strips = this.compressedBuffer;\r\n    var pixelIndex, stripIndex, index, strip;\r\n\r\n    let baseDestPixelIndex;\r\n    \r\n    for(stripIndex = 0;\r\n    stripIndex < numStrips;\r\n    ++stripIndex){\r\n\r\n    strip = strips[stripIndex];\r\n\r\n    for(pixelIndex = 0;\r\n        pixelIndex < PIXEL_STRIP_LENGTH;\r\n        pixelIndex += PIXEL_LENGTH_BLURRED){\r\n\r\n        baseDestPixelIndex = stripIndex * PIXEL_STRIP_LENGTH + pixelIndex;\r\n        var on = strip >>> 31;\r\n\r\n        var r,g,b,a;\r\n        if(on){\r\n        r = rA;\r\n        g = gA;\r\n        b = bA;\r\n        a = aA;\r\n        }\r\n        else{\r\n        r = rB;\r\n        g = gB;\r\n        b = bB;\r\n        a = aB;\r\n        }\r\n\r\n        for(let i = 0; i < PIXEL_LENGTH_BLURRED; i+=4){\r\n            imgData.data[baseDestPixelIndex+i] = r;\r\n            imgData.data[baseDestPixelIndex+i+1] = g;\r\n            imgData.data[baseDestPixelIndex+i+2] = b;\r\n            imgData.data[baseDestPixelIndex+i+3] = a;\r\n        }\r\n        strip = strip << 1;\r\n\r\n    }\r\n    }\r\n\r\n    ctx.putImageData(imgData,0,0);\r\n\r\n    return this.canvas();\r\n}\r\n\r\n\r\n// other: sprite\r\n// xoff: int\r\n// yoff: int\r\n// returns true or false\r\n// apply offset to the 'other' sprite and then test if there is any intersection between the two sprites\r\nSprite.prototype.collidesWithOffsetSprite = function(other,xoff,yoff){\r\n    return compressedOps.collide(\r\n        this.compressedBuffer,this.width,this.height,\r\n        other.compressedBuffer,other.width,other.height,\r\n        xoff+other.xoff - this.xoff, yoff + other.yoff - this.yoff);\r\n}\r\n\r\n// other: sprite\r\n// xoff: int\r\n// yoff: int\r\n// returns undefined\r\n// modifies this sprite to be the logical OR of the two sprites, where the other sprite is offset\r\nSprite.prototype.addSprite = function(other,xoff,yoff){\r\n    compressedOps.or(\r\n        this.compressedBuffer,this.width,this.height,\r\n        other.compressedBuffer,other.width,other.height,\r\n        xoff+other.xoff - this.xoff, yoff + other.yoff - this.yoff\r\n    );\r\n}\r\n\r\nmodule.exports = Sprite;","var fs = require('fs');\nlet $ = require(\"jquery\");\n\nvar fabric = require('./fabric.js');\n// var \n// var Canvas = require(\"canvas\");\n// var Canvas = require(\"canvas-browserify\");\n// var Image = Canvas.Image;\n\n\n// var toPNG = function(canvas, path, callback){\n//   var out = fs.createWriteStream(path);\n//   var stream = canvas.pngStream();\n//   stream.on('data', function(chunk){\n//     out.write(chunk);\n//   })\n//   stream.on('end', function(){\n//     out.end();\n//   });\n//   if(callback){\n//     out.on(\"finish\",callback);\n//   }\n// }\n\nvar toFabric = function(canvas, callback){\n  var fabricutils = require(\"./fabricutils.js\");\n  var dataurl = canvas.toDataURL();\n  var fabric_canvas = new fabric.StaticCanvas(canvas.width, canvas.height);\n  fabricutils.load(dataurl,function(fabric_image){\n    fabric_canvas.add(fabric_image);\n    callback(fabric_canvas);\n  });\n}\n\n// I want to resize a PNG\n// get the buffer\n// spritify that\n\n// options: \n// width - png will be stretched to this width\n// height - png will be stretched to this height\n// var imageDataFromPNG = function(png,resizeOptions,callback){\n//   var img = new Image();\n\n//   img.onload = function(){\n\n//     var naturalWidth = img.width;\n//     var naturalHeight = img.height;\n\n//     var resultWidth = resizeOptions.width ? resizeOptions.width : naturalWidth;\n//     var resultHeight = resizeOptions.height ? resizeOptions.height : naturalHeight;\n\n//     // make a canvas\n//     var canv = new Canvas(resultWidth,resultHeight);\n//     var ctx = canv.getContext('2d');\n\n//     ctx.drawImage(img,0,0,naturalWidth,naturalHeight,0,0,resultWidth,resultHeight);\n\n//     var imageData = ctx.getImageData(0,0,resultWidth,resultHeight);\n//     callback(null,imageData);\n//   }\n//   img.onerror = function(err){\n//     console.log(err);\n//     console.log(\"error loading image\");\n//   }\n\n//   img.src = png;\n// }\n\n// var resizeBuffer = function(buffer,inWidth,inHeight,outWidth,outHeight){\n//   // make a canvas to draw the buffer onto\n//   var scratchCanvas = new Canvas(inWidth,inHeight);\n//   var scratchCtx = scratchCanvas.getContext('2d');\n//   // putImageData expects an ImageData object, so let's make one\n//   var imgData = bufferToImageData(buffer,inWidth,inHeight);\n//   scratchCtx.putImageData(imgData,0,0);\n// }\n\n// var drawPNGToCanvas = function(png,canv){\n//   var img = new Image();\n//   img.src = png;\n\n//   // determine dimensions\n//   var w = img.width;\n//   var h = img.height;\n\n//   // make a canvas\n//   var canv = new Canvas(w,h);\n//   var ctx = canv.getContext('2d');\n\n//   // draw to the canvas\n//   ctx.drawImage(img,0,0);\n\n//   // save to view\n//   canvasutils.toPNG(canv,\"./tests/christCopy.png\");\n// }\n\n// var bufferToImageData = function(buffer,width,height){\n//   var scratchCanvas = new Canvas(width,height);\n//   var scratchCtx = scratchCanvas.getContext('2d');\n//   var imgData = scratchCtx.createImageData(width,height);\n//   imgData.data = buffer;\n//   return imgData;\n// }\n\n/* Input a HTML5 Canvas object */\nfunction display(canvas){\n  $(\"body\").append(canvas);\n}\n\n\n\nmodule.exports = {\n  display,\n  // toPNG: toPNG,\n  toFabric: toFabric,\n  // imageDataFromPNG: imageDataFromPNG\n  // drawBufferToCanvas: drawBufferToCanvas\n}","var fabric = require('./fabric.js');\n// var Canvas = require(\"canvas-browserify\");\nvar canvasutils = require(\"./canvasutils.js\");\nlet compressedConstants = require(\"./compressedoperations\").constants;\n\nvar phraseToFabric = function(phrase){\n  var safety_distance_from_canvas_edge = 2;\n  var left = phrase.placed_x ? phrase.placed_x : safety_distance_from_canvas_edge; \n  var top = phrase.placed_y ? phrase.placed_y : safety_distance_from_canvas_edge;\n  return new fabric.Text(\n      phrase.text,\n      {\n        left: left,\n        top: top,\n        fill: phrase.color,\n        fontFamily: phrase.font,\n        fontSize: phrase.size,\n      }\n    )\n}\n\nvar adjustedBoundingBox = function(obj){\n  var bound = obj.getBoundingRect();\n  return {\n    left:   (bound.left + 0.5) | 0,\n    top:    (bound.top + 0.5) | 0,\n    width:  bound.width | 0,\n    height: bound.height | 0\n  }\n}\n\n\n// Load an image from url (path or dataURI)\n// note that we set stroke width to 0\n// otherwise, the img will be offset by (0.5,0.5)\n// because of default strokeWidth of 1\nvar load = function(url, callback){\n  fabric.Image.fromURL(url,function(loaded_img){\n    loaded_img.setStrokeWidth(0);\n    callback(loaded_img);\n  });\n}\n\n// load canvas from JSON in a file: visualTests.js\n// scale image??\n\n\n\n// var loadAsCanvas = function(url, callback){\n//   load(url,function(loaded_img){\n//     var newCanvas = fabric.createCanvasForNode()\n//   })\n// }\n\n\nvar save = function(canv, url, callback){\n  canv.renderAll()\n  // console.log(\"saving canvas\",canv);\n  // var stream = canv.createPNGStream();\n  // var out = fs.createWriteStream(url);//__dirname + '/'+filename+'.png');\n  // // write to the fs writestream when the pngstream produces data\n  // stream.on('data', function(chunk) {\n  //   out.write(chunk);\n  // });\n  // // close the fs writestream when the pngstream has ended\n  // stream.on('end',function(){\n  //   out.end();\n  // })\n  // if(typeof callback === \"function\"){\n  //   // when the fs writestream is finished, we're all done here.\n  //   out.on('finish', function(){\n  //     callback();\n  //   });\n  // }\n\n}\n\n\n\n// unused\n// untested\nvar saveObj = function(obj, filename, callback){\n  // var bounds = obj.getBoundingRect();\n  console.log(\"w,h: \" + obj.width);\n  console.log(obj.height);\n  var canv = fabric.StaticCanvas(obj.width,obj.height);\n  canv.add(obj);\n  obj.set(\"left\",0);\n  obj.set(\"top\",0);\n  save(canv,filename, callback);\n}\n\nvar objToCanvas = function(obj){\n  var canv = fabric.StaticCanvas(obj.width,obj.height);\n  canv.add(obj);\n  obj.set(\"left\",0);\n  obj.set(\"top\",0);\n  return canv;\n}\n\nvar equalCanvases = function(canvasA, canvasB){\n\n  if(!sameDimensions(canvasA, canvasB)){\n    console.log(\"canvases have different dimensions\");\n    return false;\n  }\n\n  var w = canvasA.width, \n      h = canvasA.height, \n      len = w*h*compressedConstants.PIXEL_LENGTH;\n\n  var imageDataA = canvasA.contextContainer.getImageData(0,0,w,h);\n  var imageDataB = canvasB.contextContainer.getImageData(0,0,w,h);\n\n  var dataA = imageDataA.data;\n  var dataB = imageDataB.data;\n\n  for(var i = 0; i < len; ++i){\n    if(dataA[i] !== dataB[i]){\n      console.log(\"At [\" + i + \"]: A(\" + dataA[i] + \") != B(\" + dataB[i] + \")\" );\n      return false;\n    }\n  }\n  return true;\n}\n\nvar sameDimensions = function(canvasA, canvasB){\n  return canvasA.width === canvasB.width && canvasA.height === canvasB.height;\n}\nvar assertSameDimensions = function(canvasA, canvasB){\n  if(!sameDimensions(canvasA,canvasB)){\n    throw \"canvases aren't the same size: \"\n      + \"A width:  \" + canvasA.width  + \", \" \n      + \"A height: \" + canvasA.height + \", \"\n      + \"B width:  \"  + canvasB.width + \", \"\n      + \"B height: \" + canvasB.height\n  }\n}\n\n\nvar clearWhite = function(canv){\n  clearColor(canv,\"#FFFFFF\");\n}\nvar drawDot = function(canv,x,y){\n  canv.add(new fabric.Rect({\n    left:x,\n    top:y,\n    fill:\"black\",\n    width:1,\n    height:1\n  }))\n};\nvar clearColor = function(canv,color){\n  canv.clear();\n  canv.add(new fabric.Rect({\n    id:\"bg\",\n    left: -0.5,\n    top: -0.5,\n    fill: color,\n    width: canv.getWidth(),\n    height: canv.getHeight()\n  }));\n}\n\nvar rgbaColor = function(r,g,b,a){\n  return fabric.Color.fromSource([r,g,b,a/255]);\n}\n\n\n// var compareCanvases = function(canvasA, canvasB, url, operation, callback){\n//   assertSameDimensions(canvasA, canvasB);\n\n//   var w = canvasA.width, h = canvasA.height;\n\n//   var imageDataA = canvasA.contextContainer.getImageData(0,0,w,h);\n//   var imageDataB = canvasB.contextContainer.getImageData(0,0,w,h);\n\n//   var dataA = imageDataA.data;\n//   var dataB = imageDataB.data;\n\n//   var len = w * h * compressedConstants.PIXEL_LENGTH;\n\n//   var canvas = new Canvas(w,h);\n//   var ctx = canvas.getContext('2d');\n//   var imageData = ctx.createImageData(w,h);\n\n//   for(var i = 0; i < len; i+=4){\n//     var colorA = rgbaColor(dataA[i],dataA[i+1],dataA[i+2],dataA[i+3]);\n//     var colorB = rgbaColor(dataB[i],dataB[i+1],dataB[i+2],dataB[i+3]);\n//     var colorOut = operation(colorA, colorB);\n//     var arr = colorOut.getSource();\n//     var alpha = arr[3]*255;\n//     // console.log(JSON.stringify(arr));\n//     imageData.data[i] = arr[0];\n//     imageData.data[i+1] = arr[1];\n//     imageData.data[i+2] = arr[2];\n//     imageData.data[i+3] = alpha;\n//   }\n\n//   ctx.putImageData(imageData,0,0);\n\n//   canvasutils.toPNG(canvas,url,callback);\n//   // var other_spriter = require(\"../spriter.js\");\n//   // other_spriter.toPNG(canvas,url)\n// }\n\n// var mapCanvas = function(canvas, operation, url, callback){\n//   var w = canvas.width, h = canvas.height;\n\n//   var imageData = canvas.contextContainer.getImageData(0,0,w,h);\n\n//   var data = imageData.data;\n\n//   var len = w * h * compressedConstants.PIXEL_LENGTH;\n\n//   // var Canvas = require(\"canvas-browserify\");\n//   var outCanvas = new Canvas(w,h);\n//   var ctx = outCanvas.getContext('2d');\n//   var imageData = ctx.createImageData(w,h);\n\n//   for(var i = 0; i < len; i+=4){\n//     // var color = rgbaColor(data[i],data[i+1],data[i+2],data[i+3]);\n//     var colorOut = operation(data[i],data[i+1],data[i+2],data[i+3]);\n//     var arr = colorOut;\n//     // var arr = colorOut.getSource();\n//     // var alpha = arr[3]*255;\n//     // console.log(JSON.stringify(arr));\n//     imageData.data[i] = arr[0];\n//     imageData.data[i+1] = arr[1];\n//     imageData.data[i+2] = arr[2];\n//     imageData.data[i+3] = arr[3];\n//   } \n\n//   ctx.putImageData(imageData,0,0);\n//    canvasutils.toPNG(outCanvas,url,callback);\n//   // var other_spriter = require(\"../spriter.js\");\n//   // other_spriter.toPNG(outCanvas,url)\n// }\n\n// var map = function(canvas, operation, callback){\n//   var w = canvas.width, h = canvas.height;\n//   var imageData = canvas.contextContainer.getImageData(0,0,w,h);\n//   var data = imageData.data;\n//   var len = w * h * compressedConstants.PIXEL_LENGTH;\n\n//   var outCanvas = new Canvas(w,h);\n//   var ctx = outCanvas.getContext('2d');\n//   var imageData = ctx.createImageData(w,h);\n\n//   for(var i = 0; i < len; i+=4){\n//     var color = rgbaColor(data[i],data[i+1],data[i+2],data[i+3]);\n//     var colorOut = operation(color);\n//     var arr = colorOut.getSource();\n//     var alpha = arr[3]*255;\n//     // console.log(JSON.stringify(arr));\n//     imageData.data[i] = arr[0];\n//     imageData.data[i+1] = arr[1];\n//     imageData.data[i+2] = arr[2];\n//     imageData.data[i+3] = alpha;\n//   }\n\n//   ctx.putImageData(imageData,0,0);\n//   canvasutils.toFabric(outCanvas,callback);\n// }\n\nvar map2 = function(canvasA, canvasB, operation, callback){\n  \n}\n\nvar colorsEqual = function(colorA, colorB){\n  var srcA = colorA.getSource();\n  var srcB = colorB.getSource();\n  for(var i = 0; i < 3; ++i){\n    if(srcA[i] !== srcB[i]){\n      return false;\n    }\n  }\n  return true;\n}\n\n\nvar colorIsVisible = function(color){\n  var alphaThreshold = 200;\n  var colorThreshold = 250;\n\n  var minColor = 255-colorThreshold;\n\n  var src = color.getSource();\n  var alpha = src[3] * 255;\n\n  var opaque = alpha > alphaThreshold;\n  var low_red =src[0] < minColor;\n  var low_green = src[1] < minColor;\n  var low_blue = src[2] < minColor;\n  // return (src[0] + src[1] + src[2]) == 0 && src[3] > 250;\n  return opaque && (low_red && low_green && low_blue);\n}\n\nvar availableColor = new fabric.Color(\"#FFFFFF\");\nvar unavailableColor = new fabric.Color(\"#000000\");\n\nvar colorToAvailability = function(color){\n  return (colorIsVisible(color))? unavailableColor : availableColor;\n}\n\n\nvar zoomCanvas = function(canvas, factor) {\n  canvas.setHeight(canvas.getHeight() * factor);\n  canvas.setWidth(canvas.getWidth() * factor);\n  if (canvas.backgroundImage) {\n    // Need to scale background images as well\n    var bi = canvas.backgroundImage;\n    bi.width = bi.width * factor; bi.height = bi.height * factor;\n  }\n  var objects = canvas.getObjects();\n  for (var i in objects) {\n      var scaleX = objects[i].scaleX;\n    var scaleY = objects[i].scaleY;\n    var left = objects[i].left;\n    var top = objects[i].top;\n\n    var tempScaleX = scaleX * factor;\n    var tempScaleY = scaleY * factor;\n    var tempLeft = left * factor;\n    var tempTop = top * factor;\n\n    objects[i].scaleX = tempScaleX;\n    objects[i].scaleY = tempScaleY;\n    objects[i].left = tempLeft;\n    objects[i].top = tempTop;\n\n    objects[i].setCoords();\n  }\n  canvas.renderAll();\n  canvas.calcOffset();\n}\n\n\n\n\n\n\n\n\n\nmodule.exports = {\n  drawDot,\n  phraseToFabric: phraseToFabric,\n  adjustedBoundingBox: adjustedBoundingBox,\n  save: save,\n  load: load,\n  clearWhite: clearWhite,\n  equalCanvases: equalCanvases,\n  // compareCanvases: compareCanvases,\n  // mapCanvas: mapCanvas,\n  objToCanvas: objToCanvas,\n  colorsEqual: colorsEqual,\n  colorIsVisible: colorIsVisible,\n  colorToAvailability: colorToAvailability,\n  // map:map,\n  zoomCanvas:zoomCanvas,\n  clearColor:clearColor\n}","\nvar PIXEL_LENGTH = 4;\nvar PIXELS_PER_STRIP = 32;\nvar PIXEL_STRIP_LENGTH = PIXEL_LENGTH * PIXELS_PER_STRIP;\n\n\n//////////////////////\n/* DETECT COLLISION */\n//////////////////////\n\nvar withinTest = function(outerWidth, outerHeight, innerWidth, innerHeight, xoff, yoff){\n  var goodLeft = xoff >= 0;\n  var goodRight = innerWidth + xoff <= outerWidth;\n  var goodTop = yoff >= 0;\n  var goodBottom = innerHeight + yoff <= outerHeight;\n\n  return goodLeft && goodRight && goodTop && goodBottom;\n}\n\nvar intersectionTest = function(topWidth, topHeight, botWidth, botHeight, xoff, yoff){\n\n    // console.log(\"whwhxy: \" \n    //   + topWidth + \", \"\n    //   + topHeight + \", \"\n    //   + botWidth + \", \"\n    //   + botHeight + \", \"\n    //   + xoff + \", \"\n    //   + yoff + \", \"\n    //   )\n\n\n  var failResult = false;\n\n  // any negative dimensions means no intersection\n  if(\n    topWidth  <= 0 ||\n    topHeight <= 0 ||\n    botWidth  <= 0 ||\n    botHeight <= 0\n  ){\n    return failResult;\n  }\n\n  // any of these cases mean the rectangles don't intersect\n  if(\n    topWidth         <  xoff || // source is to the right of dest\n    topHeight        <  yoff || // source is below dest\n    xoff + botWidth  <= 0    || // source is to the left of dest\n    yoff + botHeight <= 0       // source is above dest\n    ){\n    return failResult;\n  }\n\n  var left = Math.max(0,xoff)                       // 0 <= left   <  topWidth\n  , top = Math.max(0,yoff)                          // 0 <= top    <  topHeight\n  , right = Math.min(topWidth, xoff + botWidth)     // 0 <  right  <= topWidth\n  , bottom = Math.min(topHeight, yoff + botHeight); // 0 <  bottom <= topHeight\n\n\n  // If this is true, math has been done wrong.\n  if(!(\n    0 <= left   && left   < topWidth   &&\n    0 <= top    && top    < topHeight  &&\n    0 <  right  && right  <= topWidth  &&\n    0 <  bottom && bottom <= topHeight &&\n    left < right &&\n    top  < bottom\n    )){\n    console.log(JSON.stringify({\n      left: left,\n      top: top,\n      width: right - left,\n      height: bottom - top\n    }))\n\n    throw \"Mistake with assertions of left,right,top, and bottom properties of intersection\";\n  }\n\n  return {\n    left: left,\n    top: top,\n    width: right - left,\n    height: bottom - top\n  }\n}\n\nvar operateOnCompressedRows = function(topArray, topWidth, topHeight, botArray, botWidth, botHeight, xoff, yoff, operation){\n\n  var intersect = intersectionTest(topWidth, topHeight, botWidth, botHeight, xoff, yoff);\n\n  if(!intersect){\n    throw \"they didn't intersect!\"\n    return;\n  }\n\n  // console.log(JSON.stringify(intersect));\n\n  var bottom = intersect.top + intersect.height;\n  var topOffset, botOffset;\n\n  for(var y = intersect.top; y < bottom; ++y){\n    topOffset = y * topWidth +\n      intersect.left;\n    botOffset = (y - yoff) * botWidth + \n      (intersect.left-xoff);\n    let result = operation(topArray, botArray, topOffset, botOffset, intersect.width);\n    if(result.stop){\n      // console.log(\"stopping operating. value = \" + result.value);\n      return result.value;\n    }\n  }\n  return false;\n}\n\nvar collide = function(topArray, topWidth, topHeight, botArray, botWidth, botHeight, xoff, yoff){\n  if(!withinTest(topWidth,topHeight,botWidth,botHeight,xoff,yoff)){\n    return true;\n  }\n  var result = operateOnCompressedRows(\n    topArray, topWidth, topHeight,\n    botArray, botWidth, botHeight,\n    xoff, yoff, testCompressedBitsForCollision\n  );\n  return result;\n}\n\nvar testCompressedBitsForCollision = function(topArray, botArray, topOffset, botOffset, totalBits){\n  // returns {stop: value:}\n  return operateOnCompressedBits(\n    topArray,botArray,\n    topOffset, botOffset, \n    totalBits, \n    function(topChunk, topChunkIndex, botChunk){\n      var AND = topChunk & botChunk;\n      var collision = AND != 0;\n      return {\n        stop: collision,\n        value: collision\n      }\n    }\n  );\n}\n\n\n\n\n\n\n\n\n\n\n////////\n/* OR */\n////////\nvar orBottomOntoTop = function(topArray, topWidth, topHeight, botArray, botWidth, botHeight, xoff, yoff){\n\n  return operateOnCompressedRows(\n    topArray, topWidth, topHeight,\n    botArray, botWidth, botHeight,\n    xoff, yoff, orCompressedBits\n  );\n  // orRows(topArray, topWidth, topHeight,\n  //     botArray, botWidth, botHeight,\n  //     xoff, yoff);\n}\n\n\n\n\n\n\n\n\n\n\nvar orOp = function(destArray,destIndex,srcChunk){\n  destArray[destIndex] =  (destArray[destIndex] | srcChunk);\n}\n\nvar orNotOp = function(destArray,destIndex,srcChunk){\n  destArray[destIndex] = ~(destArray[destIndex] | srcChunk);\n}\n\n\nvar or = function(topArray, topWidth, topHeight, botArray, botWidth, botHeight, xoff, yoff){\n  return opOnRows(\n    topArray, topWidth, topHeight,\n    botArray, botWidth, botHeight,\n    xoff, yoff, orOp\n  );\n}\n\n// Warning: this doesn't work! because of the function bitsFrom\n// bitsFrom sets bits that are supposed to be IGNORED to be 0\n// so since 0s signify occupied space now, those are interpreted wrong\nvar orNot = function(topArray, topWidth, topHeight, botArray, botWidth, botHeight, xoff, yoff){\n  return opOnRows(\n    topArray, topWidth, topHeight,\n    botArray, botWidth, botHeight,\n    xoff, yoff, orNotOp\n  );\n}\n\n\n\n\nvar opOnRows = function(topArray, topWidth, topHeight, botArray, botWidth, botHeight, xoff, yoff, operation){\n\n  var intersect = intersectionTest(topWidth, topHeight, botWidth, botHeight, xoff, yoff);\n\n  if(!intersect){\n    throw \"they didn't intersect!\"\n    return;\n  }\n\n\n  var bottom = intersect.top + intersect.height;\n  var topOffset, botOffset;\n\n  for(var y = intersect.top; y < bottom; ++y){\n    topOffset = y * topWidth +\n      intersect.left;\n    botOffset = (y - yoff) * botWidth + \n      (intersect.left-xoff);\n    opOnRow(\n      topArray, botArray,\n      topOffset, botOffset,\n      intersect.width,\n      operation);\n  }\n  return false;\n}\n\nvar opOnRow = function(destArray, srcArray, destOffset, srcOffset, numBits, operation){\n\n  var destChunkIndex, destChunkOffset, srcChunkIndex, srcChunkOffset;\n  var destChunk, srcChunk, numBitsOred, result;\n  // console.log(JSON.stringify(destArray));\n\n  while( numBits > 0){\n    destChunkIndex = Math.floor(destOffset / PIXELS_PER_STRIP);\n    destChunkOffset = destOffset % PIXELS_PER_STRIP;\n    srcChunkIndex = Math.floor(srcOffset / PIXELS_PER_STRIP);\n    srcChunkOffset = srcOffset % PIXELS_PER_STRIP;\n\n    destChunk = destArray[destChunkIndex];\n    srcChunk = srcArray[srcChunkIndex];\n\n    let results = chunkMask(\n      destChunk, destChunkOffset,\n      srcChunk, srcChunkOffset,\n      numBits\n    );\n\n    let numBitsProcessed = results.numBits;\n    // console.log(destChunk);\n    // console.log(srcChunk);\n    operation(destArray, destChunkIndex, results.bot);\n\n    numBits -= numBitsProcessed;\n    destOffset += numBitsProcessed;\n    srcOffset += numBitsProcessed;\n  }\n}\n\nvar chunkMask = function(topChunk, topChunkOffset, botChunk, botChunkOffset, totalBits){\n  let numBitsFromBot = Math.min(\n    PIXELS_PER_STRIP - topChunkOffset,\n    totalBits,\n    PIXELS_PER_STRIP - botChunkOffset\n  );\n  botChunk =\n    bidirectionalRightShift(\n      bitsFrom(botChunk, botChunkOffset, numBitsFromBot),\n      topChunkOffset - botChunkOffset\n    );\n\n  return {top: topChunk, bot: botChunk, numBits: numBitsFromBot}\n}\n\n\n\nvar orCompressedBits = function(topArray, botArray, topOffset, botOffset, totalBits){\n  return operateOnCompressedBits(\n    topArray,botArray,\n    topOffset, botOffset, \n    totalBits, \n    function(topChunk, topChunkIndex, botChunk){\n\n      topArray[topChunkIndex] |= botChunk;\n\n      return {\n        stop: false,\n        value: false\n      }\n    }\n  );\n}\n\n\n// make it take top array, bot array\nvar operateOnCompressedBits = function(topArray, botArray, topOffset, botOffset, totalBits, operation){\n\n  var topChunkIndex, topChunkOffset, botChunkIndex, botChunkOffset;\n  var topChunk, botChunk, numBitsOred, result;\n\n  while( totalBits > 0){\n    topChunkIndex = Math.floor(topOffset / PIXELS_PER_STRIP);\n    topChunkOffset = topOffset % PIXELS_PER_STRIP;\n    botChunkIndex = Math.floor(botOffset / PIXELS_PER_STRIP);\n    botChunkOffset = botOffset % PIXELS_PER_STRIP;\n\n    topChunk = topArray[topChunkIndex];\n    botChunk = botArray[botChunkIndex];\n\n    let results = chunkMask(\n      topChunk, topChunkOffset,\n      botChunk, botChunkOffset,\n      totalBits\n    );\n\n    let numBitsProcessed = results.numBits;\n\n    result = operation(topChunk, topChunkIndex, results.bot);\n    if(result.stop){\n      return result;\n    }\n\n    totalBits -= numBitsProcessed;\n    topOffset += numBitsProcessed;\n    botOffset += numBitsProcessed;\n  }\n  return {stop: false, value:false};\n}\n\n\n\n\n\n\n/* ALTERNATE IMPLEMENTATION */\n// reevaluate when optimizing\n\n// var orRows = function(destArray, destWidth, destHeight, srcArray, srcWidth, srcHeight, xoff, yoff){\n//   var intersect = intersectionTest(destWidth, destHeight, srcWidth, srcHeight, xoff, yoff);\n\n//   if(!intersect){\n//     throw \"they didn't intersect!\"\n//     return;\n//   }\n\n//   var bottom = intersect.top + intersect.height;\n\n//   for(var y = intersect.top; y < bottom; ++y){\n//     var destOffset = y * destWidth +\n//       intersect.left;\n//     var srcOffset = (y - yoff) * srcWidth + \n//       (intersect.left-xoff);\n\n//     orRow(destArray, srcArray, destOffset, srcOffset, intersect.width);\n//   }\n// }\n\n// var orRow = function(destArray,srcArray, destBitIndex, srcBitIndex, bitsLeft){\n//   var subA = subSprite(destArray,destBitIndex,bitsLeft);\n//   var subB = subSprite(srcArray, srcBitIndex, bitsLeft);\n//   var offsetA = Math.floor(destBitIndex % PIXELS_PER_STRIP);\n//   var offsetB = Math.floor(srcBitIndex  % PIXELS_PER_STRIP);\n//   shiftSpriteLeft(subA,offsetA);\n//   shiftSpriteLeft(subB,offsetB);\n//   var processed = subA.map(function(chunkA,index){\n//     return chunkA | subB[index];\n//   });\n//   shiftSpriteRight(processed,offsetA);\n\n//   var chunkStartIndex = Math.floor(destBitIndex / PIXELS_PER_STRIP);\n//   var chunks = subA.length;\n//   for(var i = 0; i < subA.length; ++i){\n//     destArray[chunkStartIndex + i] = processed[i];\n//   }\n// }\n\n// // only viable for\n// // 0 <= startBit\n// // 0 <= numBits\n// var subSprite = function(sprite,startBit,numBits){\n//   var endBit = startBit + numBits - 1;\n//   endBit = Math.min(endBit,sprite.length*PIXELS_PER_STRIP - 1);\n\n//   var startChunkIndex = Math.floor(startBit / PIXELS_PER_STRIP);\n//   var endChunkIndex =   Math.floor(endBit   / PIXELS_PER_STRIP);\n\n//   var numChunks = endChunkIndex - startChunkIndex + 1;\n\n//   var result = [];\n\n//   if(numChunks < 1){\n//     return result;\n//   }\n\n//   // copy over the relevant chunks\n//   for(var i = 0; i < numChunks; ++i){\n//     result[i] = sprite[startChunkIndex + i];\n//   }\n//   // shave off extra bits on leftmost chunk\n//   var offsetInStartChunk = startBit % PIXELS_PER_STRIP;\n//   result[0] = bitsFrom(result[0],offsetInStartChunk,32);\n//   // shave off extra bits on rightmost chunk\n//   var offsetInEndChunk = endBit % PIXELS_PER_STRIP;\n//   var preservedLeftBits = offsetInEndChunk + 1;\n//   result[numChunks-1] = bitsFrom(result[numChunks-1], 0, preservedLeftBits);\n\n\n//   return result;\n// }\n\n// // 0 <= shamt < 32 \n// var shiftSpriteLeft = function(sprite,shamt){\n//   if(shamt === 0)return sprite;\n//   // now 0 < shamt < 32\n//   var lastIndex = sprite.length - 1;\n//   // stop before the last element\n//   for(var i = 0; i < lastIndex; ++i){\n//     sprite[i] = sprite[i] << shamt | sprite[i+1] >>> (PIXELS_PER_STRIP-shamt)\n//   }\n//   sprite[lastIndex] = sprite[lastIndex] << shamt;\n//   return sprite;\n// }\n// // 0 <= shamt < 32\n// var shiftSpriteRight = function(sprite,shamt){\n//   if(shamt === 0)return sprite;\n//   // now 0 < shamt < 32\n//   var lastIndex = sprite.length - 1;\n//   // stop before the last element\n//   for(var i = lastIndex; i > 1; --i){\n//     sprite[i] = sprite[i] >>> shamt | sprite[i-1] << (PIXELS_PER_STRIP-shamt)\n//   }\n//   sprite[0] = sprite[0] >>> shamt;\n//   return sprite;\n// }\n\n\n\n\n\n\nvar unboundedUnsignedRightShift = function(value,shamt){\n  var shiftedTooFar = shamt >= 32 || shamt <= -32;\n  // shamt >= 32 : multiplier = 0;\n  // shamt <  32 : multiplier = 1;\n  var multiplier = 1-shiftedTooFar;\n  return multiplier * bidirectionalRightShift(value,shamt);\n}\n\n\n// integer: 32 bit unsigned\n// start: 0 <= start <= 31 : the index of first bit to include\n// num  : 0 <= num: the number of bits to try to include\n// if the supplied start or num don't fall in their ranges, garbage out.\nvar bitsFrom = function(integer, start, num){\n  // now 0 <= num <= 32\n  num = Math.min(32,num);\n\n  var fromLeft = start;\n  var fromRight = PIXELS_PER_STRIP - (start + num);\n  integer = integer  << fromLeft;\n  integer = integer >>> fromLeft;\n  integer = unboundedUnsignedRightShift(integer,fromRight);\n  integer = unboundedUnsignedRightShift(integer,-fromRight);\n  return integer;\n}\n\n// value: bits to be shifted\n// shamt: negative or positive integer\n// if shamt > 0, shift to the right, return value >> shamt\n// if shamt < 0, shift to the left, return value << shamt\n// if shamt = 0, return value\nvar bidirectionalRightShift = function(value, shamt){\n  // shamt <  0 : multiplier = 0\n  // shamt >= 0 : multiplier = 1\n  // flip the leftmost(sign) bit and shift it to the rightmost position\n  var multiplier = (~shamt) >>> 31;\n  var rightshamt = multiplier * shamt;\n  // shamt <  0 : multiplier = 1\n  // shamt >= 0 : multiplier = 0\n  multiplier = 1-multiplier;\n  var leftshamt =  - multiplier * shamt;\n  // it's important that we left shift, then right shift\n  // this makes the return value UNSIGNED as >>> returns unsigned\n  return ((value << leftshamt) >>> rightshamt);\n}\n\n\nvar fill = function(width, height, value){\n  var data = [];\n  for(var i = 0; i < width*height; ++i){\n    data[i] = value;\n  }\n  return data;\n}\n\n\n\nvar max32 = 0xFFFFFFFF;\nvar random32Bit = function(){\n  return (Math.random()*max32) | 0;\n}\n\n/////////////\n/* TESTING */\n/////////////\n\nvar assertEq = function(a,b){\n  if(a !== b){\n    throw a.toString(16) + \" was not equal to \" + b.toString(16);\n  }\n}\n\nvar testBidirectionalRightShift = function(){\n  let f = bidirectionalRightShift;\n  assertEq(f(0x0000FF00,  8), 0x0000FF00 >>  8);\n  assertEq(f(0x000000FF,-24), 0x000000FF << 24);\n}\n\nvar constants = {\n  PIXEL_LENGTH: PIXEL_LENGTH,\n  PIXELS_PER_STRIP: PIXELS_PER_STRIP,\n  PIXEL_STRIP_LENGTH: PIXEL_STRIP_LENGTH\n}\n\n\nmodule.exports = {\n  orBottomOntoTop: orBottomOntoTop,\n  or: or,\n  orNot: orNot,\n  collide: collide,\n  fill: fill,\n  constants: constants,\n  random32Bit:random32Bit,\n  __test__: {\n    bidirectionalRightShift: bidirectionalRightShift,\n    bitsFrom: bitsFrom,\n    unboundedUnsignedRightShift: unboundedUnsignedRightShift,\n    chunkMask: chunkMask,\n    // subSprite: subSprite,\n    // orRow: orRow\n  }\n}","/* The artist makes the decisions about drawing on the board\r\nit determines the initial size of text to be drawn and generates the next word to be drawn on the board */\r\n\r\nlet utils = require(\"./utils.js\");\r\nlet Text = require(\"./Text.js\");\r\nlet Board = require(\"./board.js\");\r\nlet WordCloud = require(\"wordcloud\");\r\n\r\nconst MAX_WORD_SIZE = 144;\r\nconst MIN_WORD_SIZE = 10;\r\n\r\n/* Private variables */\r\nlet curWordSize = MAX_WORD_SIZE;\r\n\r\n\r\n\r\nfunction Artist(){\r\n    /* Private variables that have public accessors */\r\n    this._id = Math.random();\r\n    this._text = \"\";\r\n    this._separator = \"breaks\";\r\n    this._words = [];\r\n    this._wordIndex = 0;\r\n    this._autoRedraw = false;\r\n    this._board = new Board();\r\n    this._serializer = new utils.Serializer();\r\n}\r\nArtist.prototype.text = function(t){this._text = t; this._words = calculateWords(this._text,this._separator);}\r\nArtist.prototype.separator = function(s){this._separator = s; this._words = calculateWords(this._text,this._separator);}\r\nArtist.prototype.board = function(b){\r\n    if(b===undefined)return this._board;\r\n    this._board = b;\r\n}\r\nArtist.prototype.words = function(){return this._words};\r\nArtist.prototype.clear = function(){ return this.board().clear();}\r\nArtist.prototype.start = function(){\r\n    curWordSize = MAX_WORD_SIZE;\r\n    this.placeEachWord().then(this.start.bind(this));\r\n    \r\n    // let wordlist = this.words().map((word,index)=>[word,30-Math.round(index/10)]);\r\n    // WordCloud(document.querySelector(\"#boardPreviewCanvas\"),{\r\n    //     list:wordlist,\r\n    //     // gridSize:1\r\n    // });\r\n}\r\nArtist.prototype.stop = function(){\r\n    this._serializer.clear();\r\n}\r\nArtist.prototype.reset = function(){\r\n    this.stop();\r\n    this.clear();\r\n    curWordSize = MAX_WORD_SIZE;\r\n    this._wordIndex = 0;\r\n}\r\nArtist.prototype.placeEachWord = function(){\r\n    return new Promise((res,rej)=>{\r\n        if(curWordSize >= MIN_WORD_SIZE){\r\n            this._words.forEach(word=>{\r\n                this._serializer.add(()=>{\r\n                    let promise;\r\n                    if(curWordSize >= MIN_WORD_SIZE){\r\n                        let t = new Text().text(word).fontSize(curWordSize);\r\n                        promise = this.board().tryToPlace(t); // try to place the word\r\n                        promise.catch(()=>{ // if we couldn't place the word anywhere\r\n                            shrinkFutureWords() // shrink subsequent words down a bit\r\n                        })\r\n                    }\r\n                    else{\r\n                        promise = Promise.reject(); // not even going to try\r\n                    }\r\n                    return promise;\r\n                })\r\n            })\r\n            this._serializer.on(res);\r\n        }\r\n        else{\r\n            this.stop();\r\n            rej();\r\n        }\r\n    })\r\n    \r\n\r\n}\r\n\r\nfunction shrinkFutureWords(){\r\n    curWordSize = 2/3 * curWordSize;\r\n    if(curWordSize < MIN_WORD_SIZE) curWordSize = MIN_WORD_SIZE;\r\n}\r\n\r\nfunction calculateWords(text,sep){\r\n    text = text || \"\";\r\n    text = text.trim();\r\n    switch(sep){\r\n    case \"commas\":\r\n        return text.split(/,+/);\r\n    break;\r\n    case \"spaces\":\r\n        return text.split(/\\s+/);\r\n    break;\r\n    case \"breaks\":\r\n    default:\r\n        return text.split(/\\n+/);\r\n    }\r\n}\r\n\r\nmodule.exports = Artist;\r\n","module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","let utils = require(\"./utils.js\");\n\n\n// var archimedean = function(x,y) {\n//   var e = x/y;\n//   var k = 5;\n//   var limit = 50;\n//   var xOrigin = x/2;\n//   var yOrigin = y/2;\n\n//   var kt = 0;\n//   var klimit = limit * k;\n\n//   return {\n//     hasNext: function(){return kt < klimit},\n//     next: function(){\n//       kt += k;\n//         return [xOrigin + e * kt * Math.cos(kt), yOrigin + kt * Math.sin(kt)];\n//     }\n//   };\n// }\n\nvar archimedean = function(x,y) {\n  var e = x/y;\n  var xOrigin = x/2;\n  var yOrigin = y/2;\n  var at = function(t) {\n    return [\n      (xOrigin + e * (t *= .1) * Math.cos(t) ) | 0,\n      (yOrigin + t * Math.sin(t) ) | 0\n    ];\n  };\n  var time = 0;\n  var nextVal;\n  return{\n    hasNext:function(){\n      nextVal = at(time+1);\n      return (nextVal[0] > 0 && nextVal[0] < x && nextVal[1] > 0 && nextVal[1] < y)\n    },\n    next:function(){\n      var result;\n      if(nextVal){\n        result = nextVal;\n        nextVal = null;\n      }\n      else{\n        result = at(time);\n      }\n      ++time;\n      return result;\n    }\n  }\n}\n\nvar random = function(x,y){\n  var MAX_ITERATIONS = 100;\n  var count = 0;\n  return{\n    hasNext: function(){return count < MAX_ITERATIONS;},\n    next:function(){\n      ++count;\n      return [\n        (Math.random()*(x) + (0) ) | 0,\n        (Math.random()*(y) + (0) ) | 0\n      ];\n    }\n  }\n}\n\nvar rectangular = function(x,y){\n   var k = 15,\n      dy = k,\n      dx = k * x / y,\n      xOrigin = x / 2,\n      yOrigin = y / 2;\n\n   var dt = 1;\n   var t = 0;\n   var limit = (x*y/169) | 0;\n   var x = xOrigin;\n   var y = yOrigin;\n\n  return {\n    hasNext: function(){return t < limit;},\n    next: function() {\n    // See triangular numbers: T_n = n * (n + 1) / 2.\n      switch ((Math.sqrt(1 + 4 * t) - 1) & 3) {\n        case 0:  x += dx; break;\n        case 1:  y += dy; break;\n        case 2:  x -= dx; break;\n        default: y -= dy; break;\n      }\n      t += dt;\n      return [x | 0, y | 0];\n    }\n  }\n}\n\nfunction LoadedSpiral(generatorFn){\n  this.t = 0;\n  this.maxT = 2;\n  this.maxMaxT = 6000;\n  this.xs = [];\n  this.ys = [];\n  this.maxX = 767;\n  this.maxY = 1024;\n  this.generateFrom(generatorFn);\n  return this;\n}\nLoadedSpiral.prototype.reset = function(){this.t = 0};\nLoadedSpiral.prototype.generateFrom = function(genFn){\n  let generator = genFn(this.maxX,this.maxY);\n  let tempTime = 0;\n  do{\n    let result = generator.next();\n    let x = result[0];\n    let y = result[1];\n    if((x>0&&x<this.maxX) && (y>0&&y<this.maxY) && tempTime < this.maxMaxT){\n      ++tempTime\n      this.xs[tempTime] = x;\n      this.ys[tempTime] = y;\n    }\n    else if(!(x>0&&x<this.maxX) && !(y>0&&y<this.maxY)){\n      this.maxT = tempTime;\n      console.log(this.xs,this.ys);\n      break;\n    }\n  }while(true);\n  return this;\n}\nLoadedSpiral.prototype.hasNext = function(){\n  return this.t < this.maxT;\n}\nLoadedSpiral.prototype.next = function(){\n  ++this.t;\n  return [this.xs[this.t],this.ys[this.t]];\n}\n\nmodule.exports = {\n  archimedean: new LoadedSpiral(archimedean),\n  rectangular: new LoadedSpiral(rectangular),\n  random: new LoadedSpiral(random)\n}","var seedrandom = require(\"seedrandom\");\n\nvar SetGlobalSeed = function(seed){\n  seedrandom(seed, { global: true });\n}\n\nvar CloneObject = function(obj){\n  var result = {};\n  for (var i in obj) {\n    if(obj.hasOwnProperty(i)){\n      result[i] = obj[i];\n    }\n  }\n  return result;\n}\nvar CloneArray = function(arr){\n  var result = [];\n  for (var i in arr) {\n    result[i] = arr[i];\n  }\n  return result;\n}\n\nvar GetRandomElement =function(array,rand){\n  return array[GetRandomIndex(array,rand)];\n}\n\nvar GetModuloElement = function(array,index){\n  var mod = array.length;\n  var mod_index = index % mod;\n  return array[mod_index];\n}\n\nvar RandomInRange = function(min,max,rand){\n  if(!rand) rand = Math.random;\n  if(min > max) throw \"random in range with min > max\";\n  var width = max-min;\n  var result = min + rand() * width;\n  return result;\n}\n\nvar RandomIntInRange = function(min,max,rand){\n  if(!rand) rand = Math.random;\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  max += 1;\n  return Math.floor(RandomInRange(min,max,rand));\n}\n\nvar RandomSubset = function(array, subset_len){\n  var all_indices = WholeNumbers(array.length);\n  var all_indices_shuffled = Shuffle(all_indices);\n  var chosen_indices = all_indices_shuffled.slice(0,subset_len);\n  return chosen_indices.map(function(index){\n    return array[index];\n  })\n}\n\nvar GetRandomIndex = function(array,rand){\n  if(!rand)rand = Math.random;\n  if(!array || array.length < 1){\n    console.error(\"Tried to get random index of empty array\");\n  }\n  var size = array.length;\n  var r = rand() * size;\n  // round down\n  r = Math.floor(r);\n  return r;\n}\n\nvar Update = function(obj, updater){\n  for(var i in updater){\n    if(obj.hasOwnProperty(i)){\n      obj[i] = updater[i];\n    }\n  }\n}\n\nvar FindClosestItemInList = function(item, list){\n  if(!list){\n    return item\n  }\n  var diff = function(a,b){\n    return Math.abs(a-b);\n  };\n  var closest = list.reduce(function (prev, curr) {\n    return (diff(item,curr) < diff(item,prev) ? curr : prev);\n  });\n  return closest;\n};\n\nvar ArrayToFrequencyObject = function(arr){\n  return arr.reduce(function(obj,item){\n    var current_count = obj[item]? obj[item] : 0\n    obj[item] = current_count + 1;\n    return obj;\n  },\n  {});\n}\n\nvar Clamp = function(min,val,max){\n  return Math.min(Math.max(min,val),max);\n}\n\nvar Shuffle = function(array){\n  var currentIndex = array.length, temporaryValue, randomIndex ;\n\n  // While there remain elements to shuffle...\n  while (0 !== currentIndex) {\n\n    // Pick a remaining element...\n    randomIndex = Math.floor(Math.random() * currentIndex);\n    currentIndex -= 1;\n\n    // And swap it with the current element.\n    temporaryValue = array[currentIndex];\n    array[currentIndex] = array[randomIndex];\n    array[randomIndex] = temporaryValue;\n  }\n\n  return array;\n}\n\nvar WholeNumbers = function(length){\n  var result = [];\n  for(var i = 0; i < length; ++i){\n    result[i] = i;\n  }\n  return result;\n}\n\nvar RemoveDuplicates = function(array){\n  return Object.keys(ArrayToFrequencyObject(array));\n}\n\nvar LogBaseBofX = function(base,x){\n  return Math.log(x) / Math.log(base);\n}\n\nvar IsString = function(variable){\n  return typeof variable === \"string\"\n}\n\n\nvar assign = function (target) {\n  // Object.assign polyfill\n  'use strict';\n  if (target === undefined || target === null) {\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  var output = Object(target);\n  for (var index = 1; index < arguments.length; index++) {\n    var source = arguments[index];\n    if (source !== undefined && source !== null) {\n      for (var nextKey in source) {\n        if (source.hasOwnProperty(nextKey)) {\n          output[nextKey] = source[nextKey];\n        }\n      }\n    }\n  }\n  return output;\n}\n\nvar isInteger = function(num){\n  return (num === (~~num));\n}\n\nvar ceil = function(num){\n  return (num+1) | 0;\n}\nvar floor = function(num){\n  return num | 0;\n}\nvar assertHasProperty = function(obj,prop){\n  console.log(prop);\n  if(obj[prop] === undefined) throw \"object doesn't have the required \" + prop + \" property.\";\n}\nvar assertHasProperties = function(obj){\n  var props = Array.prototype.slice.call(arguments,1);\n  // console.log(props);\n  props.forEach(function(prop){\n    assertHasProperty(obj,prop);\n  })\n}\n/* Observer */\nfunction Observer(){\n  this.handlers = [];\n}\nObserver.prototype.on = function(h){this.handlers.push(h)};\nObserver.prototype.off = function(r){this.handlers = this.handlers.filter(h=>h!==r)};\nObserver.prototype.notify = function(){this.handlers.forEach(h=>h(...arguments))};\n\n\n/* Timer */\nfunction Timer(){\n    this.delayTime = 1000;\n    this.repeats = false;\n    this.obs = new Observer();\n    this.handle = undefined;\n    this._inProgress = false;\n}\nTimer.prototype.stop = function(){\n    if(this.handle)clearTimeout(this.handle);\n    this.handle = undefined;\n    this._inProgress = false;\n    return this;\n}\n/* Calling start on an already started timer will do nothing\nbut even if the timer doesn't repeat, if it has finished then calling start will restart it */\nTimer.prototype.start = function(){\n    if(this._inProgress) return; // already in progress\n    this._inProgress = true;\n    this.handle = setTimeout(()=>{\n        this.obs.notify();\n        this._inProgress = false;\n        if(this.repeats)this.start();\n    },this.delayTime)\n    return this;\n}\nTimer.prototype.reset = function(){\n    this.stop();\n    this.start();\n    return this;\n}\nTimer.prototype.repeat = function(bool){ this.repeats=bool;return this;}\nTimer.prototype.delay = function(ms){this.delayTime = ms; return this;}\nTimer.prototype.repeatEvery = function(ms){this.repeats=true;this.delayTime=ms;return this;}\nTimer.prototype.destroyWith = function(scope){scope.$on(\"$destroy\",this.stop);return this;}\nTimer.prototype.then = function(f){this.obs.on(f); return this;}\n/* Helps us invoke asynchronous calls sequentially */\nfunction Serializer(){\n    this.clear();\n}\nSerializer.prototype.add = function(f){\n  this.queue.push(f);\n  if(!this.busy){\n    this.busy = true;\n    this.call().finally(this.callFinished.bind(this));\n  }\n}\nSerializer.prototype.call = function(){\n  if(this.stopping)return Promise.resolve();\n  let firstFunction = this.queue.shift();\n  return firstFunction().finally(this.callFinished.bind(this,this.id));\n}\nSerializer.prototype.callFinished = function(callerID){\n  console.log(\"call finished\",callerID);\n  if(this.id == callerID){\n    if(this.queue.length >0){\n      this.call();\n    }\n    else{\n      this.busy = false;\n      this.obs.notify();\n    }\n  }\n};\nSerializer.prototype.start = function(){\n  this.stopping = false;\n  this.call();\n}\nSerializer.prototype.stop = function(){\n  console.log(\"stopping serializer\");\n  this.stopping = true;\n}\nSerializer.prototype.on = function(){\n  return this.obs.on(...arguments);\n}\nSerializer.prototype.clear = function(){\n  this.id = Math.random();\n  this.queue = [];\n  this.obs = new Observer();\n  this.busy = false;\n  this.stopping = false;\n}\n\n/* perform a function on each element of an array in sequence, for asynchronous functions that return promises */\nfunction asyncSequentially(array,fn) {\n  let p = Promise.resolve(); // Q() in q\n\n  array.forEach(element =>{\n      p = p.then(() => fn(element)); \n  });\n  return p;\n}\n\n\nfunction getPropertySafe(){\n  let args = Array.from(arguments);\n  let obj = args.shift();\n  let result = args.reduce((acc,curr)=>{\n      if(acc === undefined || curr === undefined){\n          return undefined;\n      }\n      else{\n          return acc[curr];\n      }\n  },obj)\n  return result;\n}\n\nfunction setPropertySafe(obj,propertyName,propertyValue){\n  let args = Array.from(arguments);\n  if(args.length <  3) return;\n  if(args.length == 3){\n      obj[propertyName] = propertyValue;\n  }\n  if(args.length > 3){\n      if(obj[propertyName] == undefined){\n          obj[propertyName] = {};\n      }\n      // now obj[propName] becomse the base object\n      // and the remaining args are all shifted up one.\n      return this.setSafe(obj[propertyName],...args.slice(2));\n  }\n}\n\n\nlet toExport = {\n  getPropertySafe,\n  setPropertySafe,\n  Timer,\n  Observer,\n  Serializer,\n  asyncSequentially,\n  CloneObject: CloneObject,\n  CloneArray: CloneArray,\n  GetRandomElement: GetRandomElement,\n  GetModuloElement: GetModuloElement,\n  RandomInRange: RandomInRange,\n  RandomIntInRange: RandomIntInRange,\n  RandomSubset: RandomSubset,\n  Update: Update,\n  FindClosestItemInList: FindClosestItemInList,\n  IsString: IsString,\n  LogBaseBofX: LogBaseBofX,\n  RemoveDuplicates: RemoveDuplicates,\n  WholeNumbers: WholeNumbers,\n  Shuffle: Shuffle,\n  Clamp: Clamp,\n  ArrayToFrequencyObject: ArrayToFrequencyObject,\n  assign: assign,\n  isInteger: isInteger,\n  floor:floor,\n  ceil:ceil,\n  SetGlobalSeed: SetGlobalSeed,\n  assertHasProperties: assertHasProperties\n}\n\nmodule.exports = toExport;\n\nexport default toExport;\n","module.exports = {\r\n    BLANKET_WIDTH_PIXELS: 768,\r\n    BLANKET_HEIGHT_PIXELS: 1025\r\n}","import utils from \"./utils.js\";\n// import spriter from \"./clientSpriter.js\";\n\n/////////////\n/* PHRASES */\n/////////////\n\n\nvar textBankStrings =[\n  \"Loving Father\",\n  \"Loving Husband\",\n  \"Sweet Prince\",\n  \"John 3:16\",\n  \"Trustworthy\",\n  \"Loyal\",\n  \"Helpful\",\n  \"Friendly\",\n  \"Courteous\",\n  \"Kind\",\n  \"Obedient\",\n  \"Peaceful\"\n]; \n\n\n// var defaultString = \"path righteous beset iniquities selfish tyranny evil men. Blessed charity good shepherds weak valley darkness brother keeper lost children strike thee great vengeance furious anger poison destroy brothers Lord lay vengeance asses dead fucking fried chicken shit transitional period dumb ass Your bones don't break, mine do. That's clear. Your cells react to bacteria and viruses differently than mine. You don't get sick, I do. That's also clear. But for some reason, you and I react the exact same way to water. We swallow it too fast, we choke. We get some in our lungs, we drown. However unreal it may seem, we are connected, you and I. We're on the same curve, just on opposite ends\";\n\n\n// var defaultString = \"peace peace peace peace peace courageous honest great hard-working thoughtful talented enthusiastic loving smart incredible creative optimistic reliable patient kind skilled caring considerate generous sincere loyal passionate inventive amazing lovely missed brave adventurous calm witty courageous honest great hard-working thoughtful talented enthusiastic loving smart incredible creative optimistic reliable patient kind skilled caring considerate generous sincere loyal passionate inventive amazing lovely missed brave adventurous calm witty courageous honest great hard-working thoughtful talented enthusiastic loving smart incredible creative optimistic reliable patient kind skilled caring considerate generous sincere loyal passionate inventive amazing lovely missed brave adventurous calm witty courageous honest great hard-working thoughtful talented enthusiastic loving smart incredible creative optimistic reliable patient kind skilled caring considerate generous sincere loyal passionate inventive amazing lovely missed brave adventurous calm witty courageous honest great hard-working thoughtful talented enthusiastic loving smart incredible creative optimistic reliable patient kind skilled caring considerate generous sincere loyal passionate inventive amazing lovely missed brave adventurous calm witty courageous honest great hard-working thoughtful talented enthusiastic loving smart incredible creative optimistic reliable patient kind skilled caring considerate generous sincere loyal passionate inventive amazing lovely missed brave adventurous calm witty courageous honest great hard-working thoughtful talented enthusiastic loving smart incredible creative optimistic reliable patient kind skilled caring considerate generous sincere loyal passionate inventive amazing lovely missed brave adventurous calm witty courageous honest great hard-working thoughtful talented enthusiastic loving smart incredible creative optimistic reliable patient kind skilled caring considerate generous sincere loyal passionate inventive amazing lovely missed brave adventurous calm witty\";\n\n\nvar defaultString = \"travel gardening hiking skiing Cumberland Orioles fishing camping outdoors Bill poetry Grandaddy love family business UMD Wharton Ooggie dogs running courageous honest great hard-working thoughtful talented enthusiastic loving smart incredible creative optimistic reliable patient kind skilled caring considerate generous sincere loyal passionate inventive amazing lovely brave adventurous calm\";\n\nvar defaultTexts = [\"ping pong\",\"computers\",\"gadgets\",\"HAM Radio\",\"golf\",\"storm chasing\",\"French\",\"Cape Cod\",\"mac n cheese\",\"oil painting\",\"Pure Country\", \"Ford F150\",\"Baltimore Ravens\"];\n\n// defaultTexts = defaultTexts.concat(utils.parsePhrases(defaultString,\" \"));\n\ndefaultTexts = defaultTexts.concat(defaultTexts);\n\n\n// defaultTexts = defaultTexts.concat(defaultTexts);\n\n\n\n// var defaultTexts = defaultString.split(/ +/);\n\nutils.Shuffle(defaultTexts);\n\n// console.log(defaultTexts);\n\nvar defaultProtoPhrases = defaultTexts.map(function(text,index){\n  return {id: Math.random(), index: index, text: text};\n})\n\n\n\n//////////////\n/* PALETTES */\n//////////////\n\nvar makePalette = function(name){\n  var args = Array.prototype.slice.call(arguments,1);\n  return {\n    name: name,\n    colors: args\n  }\n}\n\nvar safeColors = [\n \"#FFFFFF\", \"#D3D3D3\", \"#9A9A9A\", \"#6F6F70\", \"#4C4C4C\", \"#313131\", \"#1F1F1F\",\n \"#161616\", \"#000003\", \"#D8E9F6\", \"#BAD1EC\", \"#627DAB\", \"#3F507C\", \"#243357\",\n \"#0D1945\", \"#091235\", \"#040B25\", \"#020510\", \"#E1FFE7\", \"#C6FFC5\", \"#87C38E\",\n \"#539852\", \"#2F5C2F\", \"#1B361D\", \"#04340D\", \"#0C2811\", \"#071B0B\", \"#010E01\",\n \"#E4FAC8\", \"#DDF89D\", \"#A7C45A\", \"#789833\", \"#597A1B\", \"#53671E\", \"#2C4704\",\n \"#193202\", \"#283108\", \"#E2E1A2\", \"#D2CF7E\", \"#AAA248\", \"#66631A\", \"#716B13\",\n \"#3C3908\", \"#E0ACC7\", \"#CD8BAA\", \"#9C5478\", \"#8F305E\", \"#5D1239\", \"#47112D\",\n \"#2A0418\", \"#1D010F\", \"#E5D7F4\", \"#D9BFF3\", \"#A98CE7\", \"#B397D0\", \"#705D98\",\n \"#5B4181\", \"#4C306B\", \"#3A1554\", \"#1D0529\", \"#D0F0EC\", \"#84B7AD\", \"#4E8283\",\n \"#316467\", \"#0A3B3E\", \"#062729\", \"#021718\", \"#E66D67\", \"#AA433B\", \"#791308\",\n \"#4F0D02\", \"#CEC9AE\", \"#B0AF88\", \"#818362\", \"#49492F\", \"#D87379\", \"#D05258\",\n \"#902C2E\", \"#650408\", \"#460205\", \"#2C0103\", \"#1A0102\", \"#F2C577\", \"#B68632\",\n \"#895005\", \"#653A03\", \"#382002\", \"#211301\", \"#F1AB89\", \"#CD6646\", \"#7F341E\",\n \"#631604\", \"#FFC98F\", \"#F3AE4C\", \"#F5973C\", \"#DA621F\", \"#A64C03\", \"#9C3204\",\n \"#EE603F\", \"#F5C4B5\", \"#D38D82\", \"#F4D6C5\", \"#F3D5A1\", \"#F2B477\", \"#D2AD89\",\n \"#D9A471\", \"#9B663B\", \"#4D2F15\", \"#341704\", \"#110A09\", \"#000000\", \"#88C7C9\",\n \"#12566A\", \"#468099\", \"#47759C\", \"#84F2BF\", \"#725943\", \"#4F3D2E\"\n];\n\nvar defaultPalette = makePalette(\"Black\",\"#000000\");\n\nvar palettes = [\n  makePalette(\"Black\",\"#000000\"),\n  makePalette(\"RGB\",\"#FF0000\",\"#00FF00\",\"#0000FF\"),\n  makePalette(\"CYM\",\"#FFFF00\",\"#00FFFF\",\"#FF00FF\"),\n  makePalette(\"Blues\",\"#0000FF\",\"#0000AA\",\"#111199\",\"#6666FF\"),\n  makePalette(\"Royal\",\"#091235\",\n    // \"#3A1554\",\n    \"#020510\",\n    \"#705D98\",\"#F3AE4C\",\"#341704\"),\n  makePalette(\"Sunshine\",\"#F3AE4C\",\"#F2C577\",\"#88C7C9\",\"#FFFFFF\"),\n  makePalette(\"Somber\", \"#243357\",\"#5B4181\",\"#84B7AD\",\"#B0AF88\",\"#D2AD89\"),\n  makePalette(\"Galaxy\",\"#D8E9F6\",\"#84F2BF\",\"#468099\",\"#3A1554\",\"#1D0529\"),\n  makePalette(\"Sunset\",\"#3A1554\",\"#D05258\",\"#705D98\",\"#EE603F\",\"#F2C577\"),\n  makePalette(\"Isolations\",\"#84F2BF\",\"#DDF89D\",\"#F2C577\",\"#DA621F\",\"#D05258\"),\n  makePalette(\"All\",\n   \"#FFFFFF\", \"#D3D3D3\", \"#9A9A9A\", \"#6F6F70\", \"#4C4C4C\", \"#313131\", \"#1F1F1F\",\n   \"#161616\", \"#000003\", \"#D8E9F6\", \"#BAD1EC\", \"#627DAB\", \"#3F507C\", \"#243357\",\n   \"#0D1945\", \"#091235\", \"#040B25\", \"#020510\", \"#E1FFE7\", \"#C6FFC5\", \"#87C38E\",\n   \"#539852\", \"#2F5C2F\", \"#1B361D\", \"#04340D\", \"#0C2811\", \"#071B0B\", \"#010E01\",\n   \"#E4FAC8\", \"#DDF89D\", \"#A7C45A\", \"#789833\", \"#597A1B\", \"#53671E\", \"#2C4704\",\n   \"#193202\", \"#283108\", \"#E2E1A2\", \"#D2CF7E\", \"#AAA248\", \"#66631A\", \"#716B13\",\n   \"#3C3908\", \"#E0ACC7\", \"#CD8BAA\", \"#9C5478\", \"#8F305E\", \"#5D1239\", \"#47112D\",\n   \"#2A0418\", \"#1D010F\", \"#E5D7F4\", \"#D9BFF3\", \"#A98CE7\", \"#B397D0\", \"#705D98\",\n   \"#5B4181\", \"#4C306B\", \"#3A1554\", \"#1D0529\", \"#D0F0EC\", \"#84B7AD\", \"#4E8283\",\n   \"#316467\", \"#0A3B3E\", \"#062729\", \"#021718\", \"#E66D67\", \"#AA433B\", \"#791308\",\n   \"#4F0D02\", \"#CEC9AE\", \"#B0AF88\", \"#818362\", \"#49492F\", \"#D87379\", \"#D05258\",\n   \"#902C2E\", \"#650408\", \"#460205\", \"#2C0103\", \"#1A0102\", \"#F2C577\", \"#B68632\",\n   \"#895005\", \"#653A03\", \"#382002\", \"#211301\", \"#F1AB89\", \"#CD6646\", \"#7F341E\",\n   \"#631604\", \"#FFC98F\", \"#F3AE4C\", \"#F5973C\", \"#DA621F\", \"#A64C03\", \"#9C3204\",\n   \"#EE603F\", \"#F5C4B5\", \"#D38D82\", \"#F4D6C5\", \"#F3D5A1\", \"#F2B477\", \"#D2AD89\",\n   \"#D9A471\", \"#9B663B\", \"#4D2F15\", \"#341704\", \"#110A09\", \"#000000\", \"#88C7C9\",\n   \"#12566A\", \"#468099\", \"#47759C\", \"#84F2BF\", \"#725943\", \"#4F3D2E\")\n]\n\n////////////\n/* SIZERS */\n////////////\n\nvar sizes = {\n  xl: 96,\n  l: 72,\n  m: 48,\n  s: 36,\n  xs: 24 // comment this out?\n}\n\nvar makeSizer = function(name,f){\n  return {name: name, f: f};\n}\n\nvar makePlateauSizer = function(width){\n  return makeSizer(\n    \"Plateau \" + width,\n    function(index){\n      if(index==0)return sizes.xl;\n      if(index < width/2) return sizes.l;\n      if(index < 2*width) return sizes.m;\n      if(index < 4*width) return sizes.s;\n      return sizes.xs;\n    }\n  );\n}\n\nvar makeStaticSizer = function(val){\n  return makeSizer(\"Static \" + val, ()=>val);\n}\n\nvar randomSizer = makeSizer(\"random\",function(index){\n  return sizes[utils.getRandomElement(Object.keys(sizes))];\n})\n\nvar sizers = [\n  randomSizer,\n  makePlateauSizer(3),\n  makePlateauSizer(10),\n  makeStaticSizer(12),\n  makeStaticSizer(24),\n  makeStaticSizer(72)\n]\n\nvar defaultSizer = randomSizer;\n\n\n///////////\n/* FONTS */\n///////////\n\n\n\n////////////\n/* SHAPES */\n////////////\n\nvar shapeNames = [\n  \"dove\",\n  \"cross\",\n  \"christ\",\n  \"fish\",\n  \"hands\"\n]\n\n// var makeShape = function(name){\n//   return {name: name, url: \"./images/\"+name+\".png\"}\n// }\n\nvar noShape = {type:\"none\",file:{}, size:\"blanket\"};\n\nvar defaultShape = noShape;\n\n// var shapes = shapeNames.map(function(name){\n//   return makeShape(name);\n// })\n\nvar namedShapeSizes = {\n  \"blanket\":{width:768,height:1025}\n}\n\n\n\n\n\n\n\n\n\n\n// var defaultSprite = spriter.fromDimensions(768,1025);\n\n\n\nexport default {\n  palettes:palettes,\n  defaultPalette: defaultPalette,\n  defaultSizer: defaultSizer,\n  sizers: sizers,\n  defaultShape: defaultShape,\n  // shapes: shapes,\n  // defaultSprite: defaultSprite,\n  defaultProtoPhrases: defaultProtoPhrases,\n  textBankStrings:textBankStrings,\n  safeColors:safeColors,\n  namedShapeSizes: namedShapeSizes\n}","import React from 'react';\nimport utils from \"../js/utils.js\";\n// import {Button,UncontrolledCollapse} from \"reactstrap\";\n// import { ListGroup, ListGroupItem } from 'reactstrap';\nimport $ from \"jquery\";\n\n\nlet timer;\nlet numRenders = 0;\nlet mostUpToDateText;\nconst CHANGE_DEBOUNCE_DURATION = 350; //ms\n\nfunction getInitialText(){\n    return `George Clark\nPure Country\nUMD\nskiing\nfamily\ntravel\noutdoors\namazing\nbusiness\ntalented\ndogs\ncourageous\nskiing\nloving\noutdoors\nfamily\nmac n cheese\ncaring\nfishing\nping pong\nadventurous\nstorm chasing\ngardening\npoetry\nreliable\nbrave\ninventive\nHAM Radio\ngenerous\nhonest\nGrandaddy\nBaltimore Ravens\nenthusiastic\noil painting\ncomputers\nmac n cheese\nOrioles\ncaring\nHAM Radio\nsmart\nconsiderate\ncourageous\nhard-working\ninventive\nsincere\nOrioles\nthoughtful\namazing\ntravel\nlove\nFord F150\npassionate\nCumberland\nPure Country\nincredible\ncamping\nloving\ntalented\nWharton\nhiking\nskilled\ngadgets\nhonest\nkind\npoetry\nbusiness\ncamping\nreliable\nWharton\ngreat\nBill\nFrench\nlovely\nskilled\nlove\ngolf\nOoggie\npassionate\ngenerous\ndogs\nBill\ngardening\nlovely\nhiking\nloyal\nrunning\ncreative\nsmart\npatient\nsincere\nkind\nBaltimore Ravens\nUMD\nbrave\nping pong\noptimistic\npatient\ncreative\nFord F150\nFrench\nCumberland\ngadgets\nenthusiastic\nGrandaddy\nconsiderate\noil painting\nrunning\nCape Cod\nhard-working\nOoggie\ngreat\nloyal\ncalm\nCape Cod\ncomputers\nadventurous\nstorm chasing\nincredible\nfishing\ncalm\ngolf\noptimistic\nthoughtful`\n  }\n\nclass TextInput extends React.Component {\n    componentDidMount() {\n        /* As an effort to debounce the many text input changes that can fire...\n            use a timer that waits until CHANGE_DEBOUNCE_DURATION ms after the last change\n            then percolates up with handleUpdate fn call\n        */\n        mostUpToDateText = getInitialText();//this.props.text;\n        $(\"#phraseInput\").val(mostUpToDateText);\n        timer = new utils.Timer().delay(CHANGE_DEBOUNCE_DURATION).then(()=>this.props.handleUpdate(mostUpToDateText)).start();\n    }\n\n    handleTextChangeEvent = (e) => {\n        mostUpToDateText = e.target.value;\n        $(\"#phraseInput\").val(mostUpToDateText);\n        timer.reset();\n    };\n\n    render() {\n        ++numRenders;\n        return (\n\n        <div>\n            <textarea\n                id=\"phraseInput\"\n                rows=\"10\"\n                // value={mostUpToDateText}\n                onChange={this.handleTextChangeEvent}>\n            </textarea>\n        </div>\n        );\n    }\n}\n\nexport default TextInput;","import React from 'react';\nimport {Dropdown} from 'primereact/dropdown';\n\nlet numRenders = 0;\nconst options = [\n    {label:\"Line Breaks\",value:\"breaks\"},\n    {label:\"Spaces\",value:\"spaces\"},\n    {label:\"Commas\",value:\"commas\"}\n]\n\nclass TextSeparation extends React.Component {\n    state = {\n        value:\"breaks\"\n    };\n\n    componentDidMount() {\n        this.props.handleUpdate(this.state.value);\n    }\n\n    handleChange = (e) => {\n        let sep = e.target.value;\n        this.props.handleUpdate(sep)\n        this.setState({value: sep});\n    };\n\n    render() {\n        ++numRenders;\n        return (\n\n        <div className=\"TextSeparation\">\n            <label>\n                Separate text by &nbsp;\n                <Dropdown\n                    value={this.state.value}\n                    options={options}\n                    onChange={this.handleChange.bind(this)}/>\n            </label>\n        </div>\n        );\n    }\n}\n\nexport default TextSeparation;","import React from 'react';\nimport {Dropdown} from 'primereact/dropdown';\n\n\nlet nameToDegreeArrays = {\n    \"flat\":[0],\n    \"cross\":[0,90],\n    \"first\":[0,-10,-20,-30,-40,-50,-60,-70,-80,-90],\n    \"fourth\":[0,10,20,30,40,50,60,70,80,90],\n    \"ltr\":[0,-10,-20,-30,-40,-50,-60,-70,-80,-90,10,20,30,40,50,60,70,80,90],\n    \"any\":[0,10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350]\n}\n\nconst options = [\n    {label:\"Flat\",value:\"flat\"},\n    {label:\"0 and 90 Degrees\",value:\"cross\"},\n    {label:\"First Quadrant\",value:\"first\"},\n    {label:\"Fourth Quadrant\",value:\"fourth\"},\n    {label:\"Left to Right\",value:\"ltr\"},\n    {label:\"Any\",value:\"any\"},\n]\n\nclass TextRotation extends React.Component {\n    state = {\n        value:\"flat\"\n    };\n\n    componentDidMount() {\n        this.handleSetRotationName(this.state.value);\n    }\n    handleSetRotationName = rotationName => {\n        let degreeArray = nameToDegreeArrays[rotationName];\n        this.props.handleUpdate(degreeArray)\n        this.setState({value: rotationName});\n\n\n        let valueArray = nameToDegreeArrays[rotationName];\n        this.props.handleUpdate(valueArray);\n        this.setState({value:rotationName});\n    }\n    \n    handleSelectEvent = (e) => {\n        let rotationName = e.target.value;\n        this.handleSetRotationName(rotationName);\n    };\n\n    render() {\n        return (\n\n        <div className=\"TextRotation\">\n            <label>\n                Text Rotation: &nbsp;\n                <Dropdown\n                    value={this.state.value}\n                    options={options}\n                    onChange={this.handleSelectEvent.bind(this)}/>\n            </label>\n        </div>\n        );\n    }\n}\n\nexport default TextRotation;","import React from 'react';\nimport settings from \"../js/settings.js\";\nvar ColorLibrary = require('color');\n\n\nclass BackgroundColorPicker extends React.Component {\n  handleColorClick = (e) => {\n    var styleString = (e.target.style.backgroundColor);\n    var c = new ColorLibrary(styleString);\n    var hex = c.hex();\n    this.props.onSetBG(this.props.bg.mode, hex);\n  };\n\n  render() {\n    var colors, preview;\n    if(this.props.bg.mode === \"transparent\"){\n      colors = [];\n      preview = <Color color=\"wheat\"/>;\n    }\n    if(this.props.bg.mode === \"palette\"){\n      colors = this.props.paletteColors;\n      preview = <Color color={this.props.bg.color}/>\n    }\n    if(this.props.bg.mode === \"all\"){\n      colors = settings.safeColors;\n      preview = <Color color={this.props.bg.color}/>\n    }\n\n\n    return(\n      <div>\n        <h3>Choose the Background Color</h3>\n        <label>\n          <input\n            type=\"radio\"\n            name=\"bg\"\n            onChange={()=>{\n              this.props.onSetBG(\"transparent\",this.props.bg.color);\n            }}\n            checked={this.props.bg.mode === \"transparent\"}/>\n          Transparent\n         </label>\n         <br/>\n        <label>\n          <input\n            type=\"radio\"\n            name=\"bg\"\n            onChange={()=>{\n              this.props.onSetBG(\"palette\",this.props.bg.color);\n            }}\n            checked={this.props.bg.mode === \"palette\"}/>\n          Palette\n         </label>\n         <br/>\n        <label>\n          <input\n            type=\"radio\"\n            name=\"bg\"\n            onChange={()=>{\n              this.props.onSetBG(\"all\",this.props.bg.color);\n            }}\n            checked={this.props.bg.mode === \"all\"}/>\n          All Colors\n         </label>\n         <br/>\n         <ColorStrip \n           handleColorClick={this.handleColorClick}\n           colors={colors}/>\n         <br/>\n         Chosen:  {preview}\n      </div>\n    );\n  }\n}\n\nclass Color extends React.Component {\n  // handleClick:function(e){\n  //   var styleString = (e.target.style.backgroundColor);\n  //   var c = new ColorLibrary(styleString);\n  //   this.props.onSetBG(c.hex());\n  // },\n  render() {\n    return (\n      <div\n      className=\"Color\"\n      style={{\"backgroundColor\": this.props.color}}\n      onClick={this.props.handleClick}>\n      </div>\n    );\n  }\n}\n\nclass ColorStrip extends React.Component {\n  render() {\n    var colors = this.props.colors.map((color,index)=>{\n      return (\n        <Color \n        key={index} \n        handleClick={this.props.handleColorClick}\n        color={color}/>\n        )\n    });\n    return (\n      <span>\n        {colors}\n      </span>\n    );\n  }\n}\n\nclass Palette extends React.Component {\n  render() {\n    return(\n      <div>\n        <label>\n          <input\n            type=\"radio\"\n            name=\"color\"\n            onChange={()=>{\n              this.props.onSetPalette({name:this.props.name,colors:this.props.colors})\n            }}\n            checked={this.props.name === this.props.selected.name}/>\n          {this.props.name}:&nbsp;\n          <ColorStrip colors={this.props.colors}/>\n        </label>\n      </div>\n    );\n  }\n}\n\nclass TextColorPicker extends React.Component{\n  render() {\n\n    var paletteObjs = settings.palettes.map((obj,index)=>{\n      return (\n        <Palette\n          key={index}\n          name={obj.name}\n          colors={obj.colors}\n          onSetPalette={this.props.onSetPalette}\n          selected={this.props.selected}\n          onSetBG={this.props.onSetBG}/>\n      );\n    })\n\n    return (\n      <div className=\"ColorBox\">\n        <h3>Choose a Palette</h3>\n        <div>\n          {paletteObjs}\n        </div>\n      </div>\n    );\n  }\n}\n\n\n// class ColorBox extends React.Component {\n//   onSetPalette = (palette) => {\n\n//   };\n\n//   render() {\n\n//     var paletteObjs = settings.palettes.map((obj,index)=>{\n//       return (\n//         <Palette\n//           key={index}\n//           name={obj.name}\n//           colors={obj.colors}\n//           onSetPalette={this.props.onSetPalette}\n//           selected={this.props.selected}\n//           onSetBG={this.props.onSetBG}/>\n//       );\n//     })\n\n//     return (\n//       <div className=\"ColorBox\">\n//         {/* <ColorDropdown/> */}\n//         <h3>Choose a Palette</h3>\n//         <div>\n//           {paletteObjs}\n//         </div>\n//         <BackgroundPicker\n//           onSetBG={this.props.onSetBG}\n//           paletteColors={this.props.selected.colors}\n//           bg={this.props.bg}/>\n//       </div>\n//     );\n//   }\n// }\n\n\n\n\nexport {TextColorPicker,BackgroundColorPicker};","import React from 'react';\nimport {MultiSelect} from 'primereact/multiselect'\nconst DEFAULT_FONTS = [\"Garamond\", \"Courier\", \"Bookman\", \"Arial\", \"Impact\"];\n\nclass FontDropdown extends React.Component {\n    // getInitialState :: a -> UIState\n    state = {\n        all:DEFAULT_FONTS.map(name=>{return{label:name,value:name}}),\n        // all:this.props.options,\n        // selected:   DEFAULT_SELECTED_FONTS  .map(name=>{return{label:name,value:name}})\n        selected: this.props.selected\n    };\n\n    // render :: a -> ReactElement\n    render() {\n        let self = this;\n  \n        return <MultiSelect\n            options = {this.state.all}\n            value = {this.state.selected}\n            onChange = {function(event){\n                let val = event.value;\n                console.log(\"SELECTIZE FONT CHANGED\",val);\n                self.setState({\n                  selected: val\n                });\n                self.props.handleChange(val);\n            }}\n            /* How to render an option in the dropdown list */\n            itemTemplate = {function(option){\n                return (\n                    <div className=\"simple-option\">\n                        <span style={{fontFamily:option.value}}>{option.label}</span>\n                    </div>\n                );\n            }}\n            /* How to render an item that has been selected\n                For some reason the argument is not a {label:blah,value:blah} but just \"blah\" */\n            selectedItemTemplate = {function(fontName){\n                if (fontName) {\n                    return (\n                        <div className=\"my-multiselected-item-token\">\n                            <span style={{fontFamily:fontName}}>{fontName}</span>\n                        </div>\n                    );\n                }\n                else {\n                    return <span className=\"my-multiselected-empty-token\">Select Fonts...</span>\n                }\n            }}\n        />\n    }\n\n    // componentWillMount :: a -> Void\n    componentWillMount() {\n    }\n}\n\n\nlet numRenders = 0;\n\nclass FontBox extends React.Component {\n    state = {\n        value:\"breaks\"\n    };\n\n    handleChange = values => {\n        this.props.handleUpdate(values);\n    };\n\n    render() {\n        ++numRenders;\n        return (\n\n        <div className=\"FontBox\">\n        {/* Fonts */}\n            <FontDropdown\n                options = {DEFAULT_FONTS}\n                selected = {this.props.selected}\n                handleChange = {this.handleChange}\n            />\n        </div>\n        );\n    }\n}\n\nexport default FontBox;","import React from 'react';\nimport {Dropdown} from 'primereact/dropdown';\nimport {ToggleButton} from 'primereact/togglebutton';\n\n\n\nclass ImageUpload extends React.Component {\n  constructor(props){\n    super(props);\n    \n    this.state = {\n      filename:\"\",\n      inverted:true\n    }\n  }\n  onDrop = (files) => {\n    var newShape = this.props.shape;\n    newShape.file = files[0];\n    // set dimensions\n    this.props.handleSetShape(newShape);\n  };\n\n  // remove this probably\n  handleSetShape = (shape) => {\n    this.props.handleSetShape(shape);\n  };\n\n  handleSetType = (type) => {\n    var newShape = this.props.shape;\n    newShape.type = type;\n    this.props.handleSetShape(newShape);\n  };\n\n  handleSetSize = (size) => {\n    var newShape = this.props.shape;\n    newShape.size = size;\n    this.props.handleSetShape(newShape);\n  };\n\n  handleSetPresetName = (presetName) => {\n    var newShape = this.props.shape;\n    newShape.presetName = presetName;\n    this.props.handleSetShape(newShape);\n  };\n  carTemplate(option) {\n    if (!option.value) {\n        return option.label;\n    }\n    else {\n        const logoPath = 'images/' + option.value;// + '.png';\n\n        return (\n            <div className=\"p-clearfix\">\n                <img alt={option.label} src={logoPath} style={{display:'inline-block',margin:'5px 0 0 5px'}} width=\"24\"/>\n                <span style={{float:'right', margin:'.5em .25em 0 0'}}>{option.label}</span>\n            </div>\n        );\n    }\n}\nselectedCarTemplate(option) {\n\n  if(option && option.value) {\n      const logoPath = 'images/' + option.value;// + '.png';\n      return (\n          <div className=\"my-multiselected-item-token\">\n              <img alt={option.label} src={logoPath} style={{width:'20px', verticalAlign:'middle', marginRight:'.5em'}} />\n              {/* <span>{option.label}</span> */}\n          </div>\n      );\n  }\n  else {\n      return <span className=\"my-multiselected-empty-token\">None</span>\n  }\n}\nonChangeFilename(e){\n  this.setState({filename:e.value});\n  this.props.onChange({filename:e.value,inverted:this.state.inverted});\n}\nonChangeInverted(e){\n  this.setState({inverted: e.value});\n  this.props.onChange({filename:this.state.filename,inverted:e.value});\n}\n\n  render() {\n    const imgs = [\n      {label:\"None\",value:\"\"},\n      {label:\"Heart\",value:\"smallheart.png\"},\n      {label:\"Fish\",value:\"fish.png\"},\n      {label:\"Cross\",value:\"cross.png\"},\n      {label:\"Christ\",value:\"christ.png\"},\n      {label:\"Dove\",value:\"dove.png\"},\n      {label:\"Hands\",value:\"hands.png\"}\n    ]\n    let extraOptions = <span></span>\n    if(this.state.filename){\n      extraOptions = <div>\n        <img width=\"90px\" height=\"120px\" src={\"./images/\"+this.state.filename} alt=\"\"/>\n        <br/>\n        <ToggleButton checked={this.state.inverted} onLabel=\"Place Words Inside\" offLabel=\"Place Words Outside\" onChange={this.onChangeInverted.bind(this)} />\n      </div>\n    }\n    \n    return (\n      <div>\n        {/* <h3> Choose Shape </h3> */}\n        <Dropdown\n        value={this.state.filename}\n        options={imgs}\n        onChange={this.onChangeFilename.bind(this)}\n        itemTemplate={this.carTemplate}\n        placeholder=\"Select a Car\"/>\n        <br/>\n        {extraOptions}\n      </div>\n    );\n    \n  }\n}\n\nexport default ImageUpload;","import React from 'react';\nimport Text from \"../js/Text.js\";\nimport Board from \"../js/board.js\";\nimport utils from \"../js/utils.js\";\nimport fabric from \"../js/fabric.js\";\n// import {InputSwitch} from 'primereact/inputswitch';\nimport {ToggleButton} from 'primereact/togglebutton';\n\nimport {Button} from 'primereact/button';\n\nconst MAX_WORD_SIZE = 144;\n\n\n\nclass BoardPreview extends React.PureComponent {\n\n    // stopUpdating(){\n    //     this.state.serializer.clear();\n    //     this.setState({allowNextWordPlacement:false})\n    // }\n    // placeNextWord(){\n    //     let word = this.state.words[this.state.wordIndex];\n    //     console.log(\"placing\",word);\n    //     let t = new Text().text(word).fontSize(this.state.curWordSize);\n    //     let p = this.state.board.tryToPlace(t);\n    //     p.finally(()=>{\n    //         this.setState({wordIndex:this.state.wordIndex+1})\n    //         if(this.state.wordIndex >= this.state.words.length){\n    //             this.setState({wordIndex:0});\n    //         }\n    //     })\n    //     return p;\n    // }\n    // placeEachWord(){\n    //     if(this.state.curWordSize < 10) return;\n    //     this.state.words.slice(1).forEach(word=>{\n    //         this.state.serializer.add(()=>{\n    //             if(this.state.curWordSize < 10) return Promise.reject();\n    //             let t = new Text().text(word).fontSize(this.state.curWordSize);\n    //             let p = this.state.board.tryToPlace(t);\n    //             p.catch(()=>{\n    //                 this.setState({curWordSize:this.state.curWordSize*2/3})\n    //             })\n    //             return p;\n    //         })\n    //     })\n    // }\n    // continueUpdating(){\n    //     if(this.state.curWordSize >= 10 && this.state.allowNextWordPlacement){\n    //         this.placeNextWord().catch(()=>{this.setState({curWordSize:this.state.curWordSize*2/3})}).finally(this.continueUpdating.bind(this));\n    //     }\n    // }\n    // startUpdating(){\n    //     this.setState({allowNextWordPlacement:true})\n    //     this.placeFirstWord().then(this.continueUpdating.bind(this))\n    // }\n    // placeFirstWord(){\n    //     return new Promise((res,rej)=>{\n    //         let t = new Text().text(this.state.words[0]).fontSize(this.state.curWordSize);\n    //         console.log(\"first word\",t);\n    //         this.state.board.tryToPlace(t).then(res).catch(()=>{\n    //             this.setState({curWordSize:Math.floor(this.state.curWordSize*4/5)})\n    //             if(this.state.curWordSize > 10){\n    //                 res(this.placeFirstWord()); // try again!\n    //             }\n    //             else{\n    //                 rej(\"couldn't place first word\");\n    //             }\n    //         })\n    //     })\n    // }\n\n\n\n    componentDidMount() {\n        let f = fabric.fromID(\"boardPreviewCanvas\");\n        this.props.board.fabcan(f);\n    }\n\n    showSprite(){\n        let spriteFabcan = fabric.fromID(\"boardPreviewSprite\");\n        this.props.board.toSprite().draw(spriteFabcan);\n    }\n\n    // toggleAutoRedraw = () => {\n    //     this.setState({autoRedraw:!this.state.autoRedraw})\n    //     if(this.state.autoRedraw){\n    //         this.startUpdating();\n    //     }\n    //     else{\n    //         this.stopUpdating();\n    //     }\n    // };\n\n    \n\n    // shouldComponentUpdate(nextProps, nextState) {\n        \n    //     return false;\n    // }\n\n    render() {\n        \n\n        return (\n        <div className=\"BoardPreview\">\n            <canvas width=\"300\" height=\"400\" id=\"boardPreviewCanvas\"></canvas>\n            {/* <canvas width=\"300\" height=\"400\" id=\"boardPreviewSprite\"></canvas> */}\n        </div>\n        );\n        \n    }\n}\n\nexport default BoardPreview;","import React from 'react';\r\nimport BoardPreview from \"../components/BoardPreview\";\r\nimport {ToggleButton} from 'primereact/togglebutton';\r\n\r\nimport {Button} from 'primereact/button';\r\n\r\n\r\nclass DrawControls extends React.Component {\r\n    state = {\r\n       autoRedraw:false\r\n    };\r\n\r\n\r\n    render() {\r\n        return (\r\n        <div className=\"DrawControls\">\r\n            {/* <ToggleButton checked={this.state.autoRedraw} \r\n            onLabel={\"Automatic Redraw On\"}\r\n            offLabel={\"Automatic Redraw Off\"}\r\n            onChange={(e) => {\r\n                this.setState({autoRedraw: e.value});\r\n                if(e.value){\r\n                    this.startUpdating();\r\n                }\r\n                else{\r\n                    this.stopUpdating();\r\n                }\r\n            }} />\r\n            <br></br> */}\r\n            {/* <Button label=\"Clear\" onClick={this.props.clear} /> */}\r\n            <Button label=\"Start\" onClick={this.props.start} />\r\n            <Button label=\"Stop\" onClick={this.props.stop} />\r\n            <Button label=\"Reset\" onClick={this.props.reset} />\r\n            {/* <Button label=\"ShowSprite\" onClick={this.props.showSprite} /> */}\r\n\r\n        </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default DrawControls;","import React from 'react';\nimport {Accordion,AccordionTab} from \"primereact/accordion\";\n\nimport 'primereact/resources/themes/nova-light/theme.css';\nimport 'primereact/resources/primereact.min.css';\nimport 'primeicons/primeicons.css';\n\n\nimport Artist from \"../js/artist.js\";\nimport Board from \"../js/board.js\";\nimport settings from \"../js/settings.js\";\n\n\nimport TextInput      from \"./TextInput.jsx\";\nimport TextSeparation from \"./TextSeparation.jsx\";\nimport TextRotation   from \"./TextRotation.jsx\";\nimport {TextColorPicker,BackgroundColorPicker}       from \"./ColorBox.jsx\";\nimport FontBox        from \"./FontBox.jsx\";\nimport ImageUpload    from \"./ImageUpload.jsx\";\nimport DrawControls   from \"./DrawControls.jsx\";\n\n\nimport BoardPreview from './BoardPreview.jsx';\n\n//shape:{\n// type: none, preset, user\n// if none: nothing\n// if preset: filename\n// if user: file\n// if preset or user: inversion / proper color and tolerance\n// }\n\n//underlay:{\n// type: none, shape, image\n// if none: nothing\n// if shape, then foreground and background colors\n// if image, then the file\n// }\n\n\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      shape:        settings.defaultShape,\n      invert:       true,\n      text:         \"hello\",\n      words:        [],\n      separator:    \",\",\n      palette:      settings.defaultPalette,\n      bg:           {mode:\"transparent\",color:\"#FFFFFF\"},\n      fonts:        [\"Courier\",\"Garamond\"],\n      // board:        new Board(),\n      artist:       new Artist()\n      \n      // underlay:     underlay.defaultUnderlay\n    };\n\n    console.log(\"new artist\",this.state.artist);\n\n    this.state.artist.board().fonts(this.state.fonts);\n  }\n\n  handleUpdateSeed = (seed) => {\n    this.setState({seed:seed});\n  };\n\n  handleUpdateText = (text) => {\n    console.log(\"handle update text\",text);\n    this.setState({text: text});\n    this.state.artist.text(text);\n    // this.calculateWords(text,this.state.separator);\n\n  };\n\n  handleUpdateSeparation = (sep) => {\n    this.setState({separator:sep});\n    this.state.artist.separator(sep);\n    // this.calculateWords(this.state.text,sep);\n  };\n\n  handleUpdateRotation = (v) => {\n    this.setState({angles:v});\n    this.state.artist.board().angles(v);\n  };\n\n  handleUpdateFont = (v) => {\n    console.log(\"updating fonts to be \",v);\n    this.setState({fonts:v});\n    this.state.artist.board().fonts(v);\n  };\n\n  handleSetPalette = (newPalette) => {\n    this.setState({palette: newPalette})\n    this.state.artist.board().palette(newPalette.colors);\n  };\n\n  handleSetBG = (mode, color) => {\n    this.setState({bg: {mode:mode,color:color}});\n    this.state.artist.board().bg({mode:mode,color:color});\n  };\n\n  handleSetShape = (newShape) => {\n    console.log(\"newshape\",newShape);\n    this.state.artist.reset();\n    setTimeout(this.state.artist.clear.bind(this.state.artist),100);\n    this.setState({shape: newShape})\n    this.state.artist.board().shape(newShape);\n    \n  };\n  calculateWords(text,sep){\n    text = text.trim();\n    switch(sep){\n    case \"commas\":\n        this.setState({words:text.split(/,+/)})\n    break;\n    case \"spaces\":\n        this.setState({words:text.split(/\\s+/)})\n    break;\n    case \"breaks\":\n    default:\n        this.setState({words:text.split(/\\n+/)})\n    }\n}\n\n\n  render() {  \n    return (\n      <div id=\"container\">\n        <div id=\"controls\">\n          <Accordion>\n            <AccordionTab header=\"Text Input\">\n                <TextInput handleUpdate={this.handleUpdateText}></TextInput>\n                <TextSeparation handleUpdate={this.handleUpdateSeparation}></TextSeparation>\n            </AccordionTab>\n            <AccordionTab header=\"Font\">\n              <FontBox handleUpdate={this.handleUpdateFont} selected={this.state.fonts}></FontBox>\n            </AccordionTab>\n            <AccordionTab header=\"Rotation\">\n              <TextRotation handleUpdate={this.handleUpdateRotation}></TextRotation>\n            </AccordionTab>\n            <AccordionTab header=\"Text Color\">\n              <TextColorPicker\n                onSetPalette={this.handleSetPalette}\n                selected={this.state.palette}\n                onSetBG={this.handleSetBG}\n                bg={this.state.bg}/>\n            </AccordionTab>\n            <AccordionTab header=\"Background Color\">\n              <BackgroundColorPicker\n                paletteColors={this.state.palette.colors}\n                onSetBG={this.handleSetBG}\n                bg={this.state.bg}/>\n            </AccordionTab>\n            <AccordionTab header=\"Cloud Shape\">\n              <ImageUpload \n              shape = {this.state.shape}\n              // onChangeInverted = {this.handleSetSh}\n              onChange = {this.handleSetShape}\n              />\n            </AccordionTab>\n          </Accordion>\n\n          {/* <ImageUpload \n            shape = {this.state.shape}\n            handleSetShape = {this.handleSetShape}\n            handleImageUpload={this.handleImageUpload}\n            invert={this.state.invert}\n            handleToggleInvert={this.handleToggleInvert}/> */}\n\n          {/* <Submitter \n            phrases={phrases}\n            bg={this.state.bg}\n            invert={this.state.invert}\n            shape={this.state.shape}\n            underlay={this.state.underlay}/> */}\n        </div>\n        <div id=\"preview\">\n          <BoardPreview\n            board={this.state.artist._board}\n          ></BoardPreview>\n          <DrawControls\n            start={this.state.artist.start.bind(this.state.artist)}\n            stop={this.state.artist.stop.bind(this.state.artist)}\n            clear={this.state.artist.clear.bind(this.state.artist)}\n            reset={this.state.artist.reset.bind(this.state.artist)}\n            showSprite = {this.state.artist.board().showSpriteOnCanvas.bind(this.state.artist.board(),\"boardPreviewSprite\")}\n          ></DrawControls>\n        </div>\n      </div>\n    );\n  }\n}\n\n\nexport default App;\n\n\n// <ShapeBox \n//   onSetShape={this.handleSetShape}\n//   selected={this.state.shape}/>","import React from 'react';\nimport logo from './logo.svg';\nimport Main from \"./components/index.jsx\"\nimport './App.css';\n\nfunction App() {\n  return (\n    // <div className=\"App\">\n    //   <header className=\"App-header\">\n    //     <img src={logo} className=\"App-logo\" alt=\"logo\" />\n    //     <p>\n    //       Edit <code>src/App.js</code> and save to reload.\n    //     </p>\n    //     <a\n    //       className=\"App-link\"\n    //       href=\"https://reactjs.org\"\n    //       target=\"_blank\"\n    //       rel=\"noopener noreferrer\"\n    //     >\n    //       Learn React\n    //     </a>\n    //   </header>\n    // </div>\n    <Main></Main>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}